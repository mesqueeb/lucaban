webpackJsonp([7],{11:function(e,t,n){"use strict";function i(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function o(e){return e.split(" ").map(function(e){return e.includes("+")||e.includes("click")?e:"<span class='o-keyboardkey'>"+e+"</span>"}).join(" ")}function r(e){if(!Array.isArray(e)||!e.length)return"";var t="";return e.forEach(function(e){t=t+","+e}),t.substring(1)}function d(e){return k()(e).map(function(t){return e[t]})}function a(e,t){return(" "+e.className+" ").includes(" "+t+" ")}function s(e,t){return(" "+e.className+" ").includes(" "+t+" ")||(e.className+=" "+t),e}function l(e,t){return e.className=" "+e.className+" ",e.className.includes(" "+t+" ")&&(e.className=e.className.replace(" "+t+" "," ")),e}function c(e){var t=[];return e=e.map(function(e){return e.trim()}),e.forEach(function(e){e.replace(/\s/g,"").length&&t.push(e)}.bind(t)),t}function u(e,t,n){return e.sort(function(e,i){var o=e[t].toUpperCase(),r=i[t].toUpperCase();return n&&"asc"!=n?"desc"==n?o>r?-1:o<r?1:0:void 0:o<r?-1:o>r?1:0}.bind(t))}function f(e,t,n,i,o){var r={prop1:t,prop2:n};return e.sort(function(e,d){t=r.prop1,n=r.prop2;var a=e[t].toUpperCase(),s=d[t].toUpperCase();if(i&&"asc"!=i){if("desc"==i){if(a>s)return-1;if(a<s)return 1;if(!e[n]||!d[n])return 0;var l=e[n].toUpperCase(),c=d[n].toUpperCase();if(console.log("text2A: "+l+" | text2B: "+c),!o||"asc"==o)return l>c?-1:l<c?1:0;if("desc"==o)return l<c?-1:l>c?1:0}}else{if(a<s)return-1;if(a>s)return 1;if(!e[n]||!d[n])return 0;var u=e[n].toUpperCase(),f=d[n].toUpperCase();if(!o||"asc"==o)return u>f?-1:u<f?1:0;if("desc"==o)return u<f?-1:u>f?1:0}}.bind(r))}function h(e,t){t=t||T.a;var n={};return e.filter(function(e){var i=t(e);return!(!i||"null"==i)&&(!n.hasOwnProperty(i)&&(n[i]=!0))})}function m(e){return _()(new I.a(e))}function p(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}n.d(t,"f",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"k",function(){return d}),n.d(t,"n",function(){return h}),n.d(t,"g",function(){return m}),n.d(t,"h",function(){return r}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return a}),n.d(t,"j",function(){return p}),n.d(t,"l",function(){return u}),n.d(t,"m",function(){return f}),n.d(t,"i",function(){return c}),n.d(t,"e",function(){return C});var g=n(178),v=n.n(g),w=n(76),I=n.n(w),y=n(42),_=n.n(y),b=n(43),T=n.n(b),D=n(7),k=n.n(D),C={tagNameToSlug:function(e){if(e&&"string"==typeof e)return e.split(" ").join("-").toLowerCase()},tagSlugToName:function(e){return e=e.replace(/-/g," "),e=e.split(" ").map(function(e){var t=v()(e),n=t[0],i=t.slice(1);return n.toUpperCase()+i.join("").toLowerCase()}).join(" ")},AplusB:function(e,t){return parseFloat(e)+parseFloat(t)}}},123:function(e,t,n){"use strict";var i=n(11),o=n(338),r=n.n(o),d=n(139),a=n(137),s=n.n(a),l=n(141),c=n.n(l);t.a={install:function(e){window.eventHub=new e,e.prototype.$bus=window.eventHub,e.bus=window.eventHub,e.directive("flatpicky",{inserted:function(e){new r.a(e,d.a)}}),e.directive("focus",{inserted:function(e,t){t.modifiers.noMobile&&n.i(i.d)()||(t.value||void 0===t.value)&&e.focus()}}),e.directive("autoheight",{inserted:function(t,n){e.nextTick(function(){s()(t)})}}),e.directive("autowidth",{inserted:function(t,n){e.nextTick(function(){c()(t)})}}),e.directive("btn-effect",{bind:function(e,t){e.addClass("btn").addClass("btn-dipclick"),e.addEventListener("click",function(t){e.addClass("btn--click"),setTimeout(function(){e.removeClass("btn--click")},400)})}}),e.directive("ios-dblclick",{inserted:function(e,t){}})}}},124:function(e,t,n){"use strict";var i=n(175),o=n.n(i),r=n(176),d=n.n(r),a=function(){function e(){o()(this,e),this.iniKeydownListenerPause(),this.iniKeyBindingListener()}return d()(e,[{key:"keystroke",value:function(e){if("journal"==store.state.selection.view&&("arrowRight"==e||"arrowLeft"==e||"meta_arrowUp"==e||"meta_arrowDown"==e||"meta_arrowRight"==e||"meta_arrowLeft"==e||"spaceBar"==e||"tab"==e||"shift_tab"==e||"t"==e||"-"==e||"s"==e)){console.log("cannot use "+e+" in journal mode");var t=store.getters.text.flashes.cannotDoThisInJournal;return console.log(t),void store.dispatch("sendFlash",{type:"warning",msg:t})}console.log(e),"meta_c"==e?store.dispatch("copyProgrammatic"):"arrowUp"==e?store.dispatch("selectItem",{direction:"prev"}):"arrowDown"==e?store.dispatch("selectItem",{direction:"next"}):"arrowRight"==e?store.dispatch("showChildren",{action:"show"}):"arrowLeft"==e?store.dispatch("showChildren",{action:"hide"}):"meta_arrowUp"==e?store.dispatch("moveItem",{direction:"up"}):"meta_arrowDown"==e?store.dispatch("moveItem",{direction:"down"}):"meta_arrowRight"==e?store.dispatch("indent"):"meta_arrowLeft"==e?store.dispatch("unindent"):"spaceBar"==e?store.dispatch("markDone"):"tab"==e?store.dispatch("indent"):"shift_tab"==e?store.dispatch("unindent"):"enter"==e?store.dispatch("showAddNewItem"):"shift_enter"==e?store.dispatch("showAddNewItem",{addAs:"child"}):"meta_enter"==e?store.dispatch("startEdit"):"ctrl_u"==e?store.dispatch("startEdit"):"t"==e?store.dispatch("setToday"):"-"==e?store.dispatch("setTomorrow"):"shift_t"==e?store.dispatch("startEditTags"):"s"==e?store.dispatch("addTimer"):"meta_shift_d"==e?store.dispatch("duplicate"):"meta_backspace"==e?store.dispatch("deleteItemDialogue"):"backspace"==e?store.dispatch("deleteItemDialogue"):"delete"==e&&store.dispatch("deleteItemDialogue")}},{key:"iniKeydownListenerPause",value:function(){window.keydownListenerPaused=!1,window.preventKeydownListener=function(){console.log("preventing keydown listener"),window.keydownListenerPaused=!0,setTimeout(function(){window.keydownListenerPaused=!1}.bind(this),500)}}},{key:"iniKeyBindingListener",value:function(){var e=this;window.addEventListener("keydown",function(t){if(!keydownListenerPaused){var n=t.keyCode;if("flatpickr-days"==document.activeElement.className&&9==n)return console.log("hiya!"),void t.preventDefault();if(store.state.popouts.delete.length||store.state.popouts.timer.length)27==n&&(t.preventDefault(),eventHub.$emit("clearAll"),console.log("Escape")),9==n&&(t.preventDefault(),t.shiftKey?store.dispatch("focusElement",{el:".btn-cancel"}):store.dispatch("focusElement",{el:".btn-ok"})),37==n&&(t.preventDefault(),store.dispatch("focusElement",{el:".btn-cancel"})),39==n&&(t.preventDefault(),store.dispatch("focusElement",{el:".btn-ok"}));else if(store.state.editingItem||store.state.addingNewUnder||store.state.editingItemTags){if("BUTTON"!=document.activeElement.nodeName)return;27==t.keyCode&&(store.state.editingItem?(store.dispatch("cancelEdit"),console.log("escapeOnEditButtonFocus")):store.state.addingNewUnder&&(store.dispatch("cancelAddNew"),console.log("escapeOnNewButtonFocus")))}else{if("INPUT"==document.activeElement.nodeName||"TEXTAREA"==document.activeElement.nodeName||"A"==document.activeElement.nodeName||"BUTTON"==document.activeElement.nodeName)return void console.log("inputs or buttons are focussed!");switch(t.keyCode){case 37:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowLeft");break}e.keystroke("arrowLeft");break;case 39:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowRight");break}e.keystroke("arrowRight");break;case 38:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowUp");break}e.keystroke("arrowUp");break;case 40:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowDown");break}e.keystroke("arrowDown");break;case 32:t.preventDefault(),e.keystroke("spaceBar");break;case 9:if(t.preventDefault(),t.shiftKey){e.keystroke("shift_tab");break}e.keystroke("tab");break;case 13:t.preventDefault(),t.ctrlKey||t.metaKey?e.keystroke("meta_enter"):t.shiftKey?e.keystroke("shift_enter"):e.keystroke("enter");break;case 84:t.preventDefault(),t.ctrlKey||t.metaKey||t.shiftKey?e.keystroke("shift_t"):e.keystroke("t");break;case 83:e.keystroke("s");break;case 85:if(t.ctrlKey){e.keystroke("ctrl_u");break}e.keystroke("u");break;case 68:if(t.preventDefault(),(t.ctrlKey||t.metaKey)&&t.shiftKey){e.keystroke("meta_shift_d");break}break;case 8:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_backspace");break}e.keystroke("backspace");break;case 46:t.preventDefault(),e.keystroke("delete");break;case 67:if((t.ctrlKey||t.metaKey)&&0==window.getSelection().toString()){t.preventDefault(),e.keystroke("meta_c");break}case 189:t.preventDefault(),e.keystroke("-")}}}})}}]),e}();t.a=a},125:function(e,t,n){"use strict";function i(e){return function(){return n(350)("./"+e+".vue")}}var o=n(66),r=n(346);o.a.use(r.a),t.a=new r.a({routes:[{path:"/",component:i("Index"),children:[{path:"",component:i("Listo")},{path:"login",component:i("Login")}]},{path:"*",component:i("Error404")}]})},126:function(e,t,n){"use strict";var i=n(170),o=n(162),r=n(169),d=n(161),a=n(167),s=n(168),l=n(164),c=n(166),u=n(165);t.a={state:i.a,getters:o.a,mutations:r.a,actions:d.a,modules:{user:a.a,userSettings:s.a,api:l.a,selection:c.a,newItem:u.a}}},127:function(e,t){},128:function(e,t){},132:function(e,t,n){function i(e){n(337)}var o=n(135)(n(159),n(345),i,null,null);e.exports=o.exports},136:function(e,t,n){"use strict";function i(e){return o(e)}function o(e){function t(e){return("0"+e).slice(-2)}var n=void 0,i=Math.floor(e/60);n=e%60;var o=Math.floor(i/60);return i%=60,o>0?t(o)+":"+t(i)+":"+t(n):t(i)+":"+t(n)}function r(e){function t(e,t){return e>0?e+" "+t:""}var n=void 0,i=Math.floor(e/60);n=e%60;var o=Math.floor(i/60);return i%=60,o>0?t(o,c.global.hour+" ")+t(i,c.global.min):i>0?t(i,c.global.min+" ")+t(n,c.global.sec):t(n,c.global.sec)}function d(e){function t(e,t){return e>0?e+" "+t:""}var n=Math.floor(e/60);var i=Math.floor(n/60);return n%=60,i>0?t(i,c.global.hour+" ")+t(n,c.global.min):t(n,c.global.min)}function a(e){e=new Date(e);var t=n.i(s.b)(e,new Date,{addSuffix:!0});return t.substring(0,t.indexOf(" at"))}n.d(t,"e",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return a});var s=n(40),l=n(74),c=window.store?store.getters.text:l.a.en},139:function(e,t,n){"use strict";t.a={dateFormat:"Y-m-d H:i:S",maxDate:"today",time_24hr:!0,onOpen:function(e,t,n){var i=n.element.name;store.state.beforeEditCache_doneDate||(store.state.beforeEditCache_doneDate={}),console.log("flatPickr[onOpen] id: "+i+".    dateStr: "+t),store.state.beforeEditCache_doneDate[i]=t},onClose:function(e,t,n){var i=n.element.name;console.log("flatPickr[onClose] id: "+i+".    dateStr: "+t),console.log("store.state.beforeEditCache_doneDate[id] = "+store.state.beforeEditCache_doneDate[i]),store.state.beforeEditCache_doneDate[i]!=t&&(store.dispatch("patch",{id:i,field:"done_date",value:t}),delete store.state.beforeEditCache_doneDate[i])}}},159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),o=n(65),r=n.n(o),d=n(66),a=n(29),s=n(130),l=(n.n(s),n(129)),c=(n.n(l),n(134)),u=n(126),f=n(133),h=n.n(f),m=n(125),p=n(124),g=n(123),v=n(131),w=n.n(v);n(127),window.Element.prototype.hasClass=function(e){return n.i(i.a)(this,e)},window.Element.prototype.addClass=function(e){return n.i(i.b)(this,e)},window.Element.prototype.removeClass=function(e){return n.i(i.c)(this,e)},window.axios=r.a,window.Vue=d.a,d.a.config.productionTip=!1,d.a.use(a.a,{components:{QBtn:a.b,QIcon:a.c,QPopover:a.d,QModal:a.e,QSpinnerOval:a.f,QLayout:a.g,QFixedPosition:a.h}}),d.a.use(c.a),window.store=new c.a.Store(u.a),d.a.use(h.a),window.router=m.a,new p.a,d.a.use(g.a),d.a.use(w.a),window.vm=new d.a({el:"#q-app",router:m.a,store:store,render:function(e){return e(n(132))}}),n(128)},161:function(e,t,n){"use strict";var i,o=n(177),r=n.n(o),d=n(172),a=n.n(d),s=n(7),l=n.n(s),c=n(43),u=n.n(c),f=n(40),h=n(11);t.a=(i={flattenTree:function(e,t){var n=(e.state,e.commit,e.dispatch,e.getters),i=t.array;console.log("flattening tree...");var o=[];return i.forEach(function(e){o.push(e),e.children.length&&Array.prototype.push.apply(o,n.flattenTree(e.children))}),o},giveNewParent:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=r.id,a=r.new_parent_id,s=r.specificNewIndex;if(o.isTopLvlItemInFilteredRoot(d)){var l=o.text.flashes.moveTopLvlItem;return console.log(l),void i("sendFlash",{type:"warning",msg:l})}console.log("giving new parent");var c=t.nodes[d].parent_id,u=t.nodes[d],f=t.nodes[a];console.log("newParent ↓ "),console.log(f);var h=t.nodes[c];console.log("prevParent ↓ "),console.log(h);var m=o.siblingIndex(d);if(n("updateState",{id:d,field:"parent_id",value:a}),n("updateState",{id:d,field:"depth",value:f.depth+1}),f.children_order||n("updateState",{id:a,field:"children_order",value:[]}),s||0==s)n("addChild",{index:s,item:u,newParentId:a});else if(h.depth-1==f.depth&&a==h.parent_id){var p=o.siblingIndex(h.id)+1;n("addChild",{index:p,item:u,newParentId:a})}else n("addChild",{item:u,newParentId:a});n("updateState",{field:"show_children",id:a,value:1}),n("deleteChild",{index:m,id:h.id}),0==h.children.length&&n("updateState",{field:"children",id:h.id,value:[]}),i("attachParentBody",{id:d}),i("tagItem",{id:d,tags:o.itemTagArray(a)}),i("patch",{id:d,field:"depth"}),i("patch",{id:d,field:"parent_id"}),i("patch",{id:a,field:"children_order"}),i("patch",{id:a,field:"show_children"}),i("patch",{id:c,field:"children_order"}),i("updateChildrenDepth",{id:u.id}),i("updateChildrenDueDate",{id:a}),i("updateChildrenDueDate",{id:c}),i("autoCalculateDoneState",{id:a}),i("autoCalculateDoneState",{id:c})},duplicate:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;r=r||t.selection.selectedId;var d=t.nodes[r],a=i.siblingIndex(r)+1,s=JSON.parse(u()(d));n("postNewItem",{newItem:s,index:a,addNextItemAs:null,addTags:s.tagged.map(function(e){return e.tag_name}),duplication:!0})},addAndCleanNodesRecursively:function(e){var t=(e.state,e.commit),n=e.dispatch,i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.item;r=i.setDefaultItemValues(r),t("addNode",{item:r}),r.children&&r.children.forEach(function(e){return n("addAndCleanNodesRecursively",{item:e})})},addItem:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=r.item,a=r.index,s=r.addNextItemAs,l=r.addTags,c=r.duplication;if(i("addAndCleanNodesRecursively",{item:d}),n("deleteTempItem",{item:d}),n("addChild",{newParentId:d.parent_id,index:a,item:d}),t.selection.selectedId=d.id,i("patch",{id:d.parent_id,field:"children_order"}),l&&i("tagItem",{id:d.id,tags:l}),i("attachParentBody",{id:d.id}),i("autoCalculateDoneState",{id:d.parent_id}),"journal"==t.selection.view&&(t.selection.view=null,t.selection.view="journal"),o["selection/dueTodayFiltered"]&&(t.selection.filter.dueDate.to=null,t.selection.filter.dueDate.to=new Date),t.selection.tags.length){var u=t.selection.tags;t.selection.tags=[],t.selection.tags=u}c||"stop"==s?t.addingNewUnder=null:i("showAddNewItem",{id:d.id,addAs:s}),Vue.nextTick(function(){return i("scrollToItemIfNeeded",{id:d.id})})},addTempNewItem:function(e){var t=(e.state,e.commit),n=e.dispatch,i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.item,r=i.index,d=i.addNextItemAs;i.addTags;console.info("adding Temp item"),o=JSON.parse(u()(o)),o.id="tempItem_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),o.temp=!0,console.log("temp item:"),console.log(o),n("addAndCleanNodesRecursively",{item:o}),t("addChild",{newParentId:o.parent_id,index:r,item:o}),t("updateState",{addingNewUnder:o.id}),"stop"==d&&Vue.nextTick(function(){return n("scrollToItemIfNeeded",{id:o.id})})},hideTaggedNodes:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.tag;l()(t.nodes).forEach(function(e){e=parseFloat(e),n.hasTag(e,o)&&(t.selection.hiddenItems.includes(e)||t.selection.hiddenItems.push(e))})},hideDoneNodes:function(e){var t=e.state;e.commit,e.dispatch,e.getters;l()(t.nodes).forEach(function(e){e=parseFloat(e),t.nodes[e].done&&(t.selection.hiddenItems.includes(e)||t.selection.hiddenItems.push(e))})},sortAllChildren:function(e){var t=e.state,n=(e.commit,e.dispatch);e.getters;t.root.children&&t.root.children.length&&(console.log("sorting all items"),l()(t.nodes).forEach(function(e){n("sortChildren",{id:e}),n("updateChildrenDueDate",{id:e})}))},sortChildren:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id,o=t.nodes[i];o.children_order=o.children_order.filter(function(e){return o.children.includes(t.nodes[e])});var r=o.children_order,d=o.children;r instanceof Array&&r.length&&(o.children=r.map(function(e){return d.find(function(t){return t.id===e})}))},updateChildrenDepth:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.id,r=t.nodes[o].children;if(!r&&!r.length)return!1;r.forEach(function(e){return console.log(e),e.depth=t.nodes[e.parent_id].depth+1,n("patch",{id:e.id,field:"depth"}),n("updateChildrenDepth",{id:e.id}),!0})},copyParentBodyToAllChildren:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.parent_id;if(o){var r=t.nodes[o];if(r.children_order.length){var d=r.body;r.children_order.forEach(function(e){var i=t.nodes[e];i.parents_bodies=d,vm&&n("patch",{id:i.id,field:"parents_bodies"})})}}},attachParentBody:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.id;if(o){var r=t.nodes[o];if(r.parent_id){var d=t.nodes[r.parent_id];d&&(r.parents_bodies=d.body,n("patch",{id:o,field:"parents_bodies"}))}}},deleteItem:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;r||console.log("item id not specified at deleteItem");var d=t.nodes[r],a=i.prevItemId(r)?i.prevItemId(r):null;if(Array.isArray(d.children)&&d.children.length){n("deleteItemApi",{idOrArray:i.getAllChildrenIds(r)})}var s=d.parent_id,l=t.nodes[s];if(l){var c=i.siblingIndex(r);l.children.splice(c,1),l.children_order.splice(c,1),n("patch",{id:s,field:"children_order"})}n("deleteItemApi",{idOrArray:r}),"journal"==t.selection.view&&(t.selection.view=null,t.selection.view="journal"),"tree"==t.selection.view&&(t.selection.view="journal",t.selection.view="tree"),i["selection/dueTodayFiltered"]&&(t.selection.filter.dueDate.to=null,t.selection.filter.dueDate.to=new Date);var u=i.nextItemId(a)?i.nextItemId(a):null;console.log("new selected ID is: "+u),t.selection.selectedId=u,delete t.nodes[r]},tagItem:function(e){var t=e.state,i=(e.commit,e.dispatch),o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.selection.selectedId,tags:t.newTag},d=r.id,a=r.tags,s=void 0===a?t.newTag:a;if(s&&(s=JSON.parse(u()(s)),t.newTag=null,Array.isArray(s)||(s=[s]),s=n.i(h.i)(s),s=s.filter(function(e){return!o.hasTag(d,e)}),s.length)){i("patchTag",{id:d,tags:s});var l=t.nodes[d];l.children.length&&l.children_order.forEach(function(e){i("tagItem",{id:e,tags:s})})}},prepareTag:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id;n.tags,t.nodes[i]},prepareDonePatch:function(e){var t=e.state,i=(e.commit,e.dispatch),o=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),r=o.id,d=t.nodes[r],a=n.i(f.a)(new Date,"YYYY-MM-DD HH:mm:ss");d.done_date=a,i("patchDone",{id:r}),d.done&&i("popup",{id:r,type:"afterDone"}),d.done&&i("attachParentBody",{id:r})},autoCalculateDoneState:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;0!=t.nodes[r].depth&&(1!=i.allChildrenDone(r)||i.isProject(r)?n("markDone",{id:r,markAs:"notDone"}):n("markDone",{id:r,markAs:"done"}))},updateItemTagsDom:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.id,r=i.tags,d=i.requestType;if(r){if(Array.isArray(r))return void r.forEach(function(e){return n("updateItemTagsDom",{id:o,tags:e,requestType:d})});var a=r.trim(),s=h.e.tagNameToSlug(a),l={temp:"temp",tag_name:a,tag_slug:s,tag:{name:a,slug:s}};"tag"!=d&&d||(console.log(t.nodes[o].tagged),t.nodes[o].tagged.push(l),console.log(t.nodes[o].tagged)),"untag"==d&&(t.nodes[o].tagged=t.nodes[o].tagged.filter(function(e){return e.tag_slug!=s}))}},moveItem:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id,d=o.direction;if(r=r||t.selection.selectedId,i.isTopLvlItemInFilteredRoot(r)){var a=i.text.flashes.moveTopLvlItem;return console.log(a),void n("sendFlash",{type:"warning",msg:a})}clearTimeout(window.patchDelay);var s=t.nodes[r].parent_id,l=t.nodes[s],c=i.siblingIndex(r);if("up"==d)if(0==c){if(0==l.depth)return void console.log("ceiling!");var u=i.olderSiblingId(s),f=u==l.parent_id?0:null;n("giveNewParent",{id:r,new_parent_id:u,specificNewIndex:f})}else l.children_order.splice(c,1),l.children_order.splice(c-1,0,r),n("sortChildren",{id:s}),window.patchDelay=setTimeout(function(){n("patch",{id:s,field:"children_order"})},1e3);else if("down"==d)if(c+1==l.children_order.length){if(0==l.depth)return void console.log("floor!");var h=i.nextSiblingOrParentsSiblingId(r);console.log("new_parent_id: "+h),n("giveNewParent",{id:r,new_parent_id:h,specificNewIndex:0})}else l.children_order.splice(c,1),l.children_order.splice(c+1,0,r),n("sortChildren",{id:s}),window.patchDelay=setTimeout(function(){n("patch",{id:s,field:"children_order"})},1e3);Vue.nextTick(function(){return n("scrollToItemIfNeeded",{id:r})})},flushDoneItems:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,t.nodes),o=l()(i);o.reduce(function(e,t){i[t].done&&n("deleteItem",{id:t})})},setDueDate:function(e){var t=e.state,i=(e.commit,e.dispatch),o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=r.id,a=r.duedate,s=a?new Date(a):new Date,l=new Date(t.nodes[d].due_date),c=n.i(f.c)(l,s);0==c&&(s="0000-00-00 00:00:00"),t.nodes[d].due_date=n.i(f.a)(s,"YYYY-MM-DD hh:mm:ss"),0==c&&o["selection/dueTodayFiltered"]&&(t.selection.selectedId=o.nextItemId(d)),i("patchDueDate",{id:d,duedate:s}),i("updateChildrenDueDate",{id:d})},updateChildrenDueDate:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.id,r=t.nodes[o];if(!r.children.length)return!1;r.children.forEach(function(e){r.dueDateParent?(e.dueDateParent=r.dueDateParent,n("updateChildrenDueDate",{id:e.id})):r.due_date&&"0000-00-00 00:00:00"!=r.due_date?(e.dueDateParent=r.due_date,n("updateChildrenDueDate",{id:e.id})):(e.dueDateParent=!1,n("updateChildrenDueDate",{id:e.id}))})},formatDone:function(e){var t=(e.state,e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=t.doneArray,o=i.reduce(function(e,t){if(t.done){var i=n.i(f.a)(t.done_date,"YYYY/MM/DD");e.hasOwnProperty(i)||(e[i]=[]),e[i].push(t)}return e},{});return l()(o).map(function(e){var t={};return t.date=e,t.items=o[e],t})},blockBlur:function(e){var t=e.state;e.commit,e.dispatch,e.getters;t.blockBlur=!0,setTimeout(function(){t.blockBlur=!1},500)},startEdit:function(e){var t=e.state,n=e.commit,i=(e.dispatch,e.getters),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.item,d=o.event;d&&(d.srcElement.hasClass("done")||d.srcElement.hasClass("custom-tag"))||(console.log("startEdit"),r=r||t.nodes[t.selection.selectedId],n("updateState",{beforeEditCache_body:r.body}),n("updateState",{beforeEditCache_planned_time:r.planned_time}),n("updateState",{editingItem:r.id}),i.mobile&&store.$refs["edit-item-modal-"+r.id].open())},scrollToItemIfNeeded:function(e){var t=(e.state,e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=t.id;if(i){var o=document.getElementById("item-body-"+i);n.i(h.j)(o)||o.scrollIntoView()}},doneEdit:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.editingItem},d=r.id,s=void 0===d?t.editingItem:d;console.log("Done edit!"),i("blockBlur"),o.mobile&&store.$refs["edit-item-modal-"+s].close();var l=t.nodes[s];if(n("updateState",{editingItem:null}),n("updatePopouts",{edit:[]}),t.editingItemTags)return void n("updateState",{editingItemTags:null});l.body||n("updateState",{id:s,body:t.beforeEditCache_body}),("number"!=typeof l.planned_time||a()(l.planned_time))&&n("updateState",{id:s,planned_time:0}),l.planned_time!=t.beforeEditCache_planned_time&&i("patch",{id:s,field:"planned_time"}),l.body!=t.beforeEditCache_body&&(i("patch",{id:s,field:"body"}),i("copyParentBodyToAllChildren",{parent_id:s})),n("updateState",{beforeEditCache_body:null}),n("updateState",{beforeEditCache_planned_time:null})},cancelEdit:function(e){var t=e.state,n=e.commit,i=(e.dispatch,e.getters),o=t.editingItem?t.editingItem:t.editingItemTags;o&&(i.mobile&&store.$refs["edit-item-modal-"+o].close(),t.editingItem&&Vue.nextTick(function(){console.log("cancel edit. Reverting to: "+t.beforeEditCache_body),n("updateState",{id:o,body:t.beforeEditCache_body}),n("updateState",{id:o,planned_time:t.beforeEditCache_planned_time})}),n("updateState",{editingItem:null}),n("updateState",{editingItemTags:null}),n("updatePopouts",{edit:[]}))},cancelEditOrAdd:function(e){var t=e.state,n=(e.commit,e.dispatch);e.getters;preventKeydownListener(),n("blockBlur"),t.addingNewUnder?n("cancelAddNew"):(t.editingItem||t.editingItemTags)&&n("cancelEdit")},cancelAddNew:function(e){var t=e.state;e.commit,e.dispatch;e.getters.mobile&&store.$refs["add-item-modal"].close(),console.log("cancelAddNew"),t.selection.selectedId!=t.addingNewUnder&&null!=t.selection.selectedId||(t.selection.selectedId=t.selection.lastSelectedId),t.addingNewUnder=null,t.addingNewAsChild=!1},addNew:function(e){var t=e.state,i=(e.commit,e.dispatch),o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{addNextItemAs:null},d=r.addNextItemAs;i("blockBlur"),o.mobile&&"stop"==d&&store.$refs["add-item-modal"].close(),console.log("addingNew");var a=JSON.parse(u()(t.newItem)),s=t.addingNewUnder,l=o["newItem/preparedPlusComputedTags"];if(a.body){!s&&t.selection.selectedId?s=t.selection.selectedId:s||t.selection.selectedId||(s=t.root.id);var c=t.nodes[s];a.parent_id=c.parent_id?c.parent_id:t.root.id,a.depth=c.depth?c.depth:1;var h=o.siblingIndex(c.id),m=isNaN(h)?0:h+1;if(console.log("\n\t\tadding new item["+a.body+"]\n\t\twith parent id = "+a.parent_id+"\n\t\tdepth = "+a.depth+"\n\t\tindex = "+m),t.addingNewAsChild&&(a.depth=c.depth+1,a.parent_id=c.id,m=0),"journal"==t.selection.view){a.done=1;var p=c&&0!=c.depth?c.done_date:n.i(f.a)(new Date,"YYYY-MM-DD HH:mm:ss");a.done_date=p}o["selection/dueTodayFiltered"]&&o.isTopLvlItemInFilteredRoot(c.id)&&!t.addingNewAsChild&&(a.due_date=n.i(f.a)(new Date,"YYYY-MM-DD HH:mm:ss"),l=l.filter(function(e){return"Today"!=e})),console.log("sending newItem:"),console.log(JSON.parse(u()(a))),console.log("sending tags:"),console.log(l),store.commit("resetNewItem"),i("addTempNewItem",{item:a,index:m,addNextItemAs:d,addTags:l}),i("postNewItem",{newItem:a,index:m,addNextItemAs:d,addTags:l,duplication:null})}},checkFilteredItemsTree:function(e){var t=e.state,i=(e.commit,e.dispatch,e.getters);n.i(h.k)(t.nodes).forEach(function(e){var o=void 0,r=void 0,d=void 0,a=void 0;if(i.selection.nothingSelected){if(1==e.depth)return!0}else if(o=t.selection.tags.every(function(t){return i.hasTag(e.id,t)}),r=t.selection.hiddenTags.some(function(t){return i.hasTag(e.id,t)}),d=t.selection.tags.some(function(t){return i.hasParentWithTag(e.id,t)}),a=!0,i["selection/dueTodayFiltered"]){a=!1;var s=n.i(f.c)(new Date(e.due_date),new Date);s<=0&&(a=!0)}o&&console.log("target = ["+e.body+"]\n\t\t\thidden: "+r+"\n\t\t\tparentwithTag: "+d+"\n\t\t\ttargetToday: "+a)})},showChildren:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.id,r=i.action;o=o||t.selection.selectedId;var d=t.nodes[o];if(d.children&&d.children.length){if("show"==r){if(d.show_children)return;d.show_children=!0}else if("hide"==r){if(!d.show_children)return;d.show_children=!1}else d.show_children=!d.show_children;n("patch",{id:o,field:"show_children"})}},markDone:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id,d=o.markAs;if(r=r||t.selection.selectedId){var a=t.nodes[r];if(a)return"notDone"==d?(a.done=!1,void n("prepareDonePatch",{id:r})):void(a.children.length&&!i.allChildrenDone(r)||(a.done="done"==d||!a.done,n("prepareDonePatch",{id:r})))}},indent:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;r=r||t.selection.selectedId;var d=i.olderSiblingId(r);if(d==t.nodes[r].parent_id)return void console.log("bump! ceiling!");console.log("new_parent_id / olderSiblingId: "+d),n("giveNewParent",{id:r,new_parent_id:d})},unindent:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;r=r||t.selection.selectedId;for(var d=t.nodes[r].depth,a=i.olderSiblingId(r),s=t.nodes[a].depth;s!=d-1;)a=i.olderSiblingId(a),s=t.nodes[a].depth;var l=a,c=s;return console.log("new_parent: "+l),l?0==c&&1==d?void console.log("crash! floor!"):(l==t.nodes[r].parent_id&&(l=t.nodes[l].parent_id),void n("giveNewParent",{id:r,new_parent_id:l})):void console.log("crash! floor!")},selectItem:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id,d=o.direction;r=r||t.selection.selectedId;var a=void 0;if(d){if("next"==d)a=r&&r!=t.root.id?i.nextItemId(r):vm.$refs.root.childrenOrder[0];else if("prev"==d)if(r&&r!=t.root.id)a=i.prevItemId(r);else{var s=vm.$refs.root.childrenOrder.length;a=vm.$refs.root.childrenOrder[s-1]}}else a=r;t.selection.selectedId=a,n("scrollToItemIfNeeded",{id:a})},setToday:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;if(r=r||t.selection.selectedId)return i.hasParentDueToday(r)?void console.log("parent is already due"):void n("setDueDate",{id:r})},setTomorrow:function(e){var t=e.state,i=(e.commit,e.dispatch),o=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),r=o.id;if(r=r||t.selection.selectedId){i("setDueDate",{id:r,duedate:n.i(f.d)(new Date,1).format("YYYY-MM-DD HH:mm:ss")})}},showAddNewItem:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id,r=i.addAs;n.mobile&&store.$refs["add-item-modal"].open(),(o=o||(t.selection.selectedId?t.selection.selectedId:t.root.id))&&(console.log("showAddNewItem for ["+t.nodes[o].body+"]"),t.addingNewUnder=o,t.selection.lastSelectedId=o,t.selection.selectedId=null,t.addingNewAsChild="child"==r)},startEditTags:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id;(i=i||t.selection.selectedId)&&(t.editingItemTags=i)},stopPatching:function(e){var t=e.state;e.commit,e.dispatch,e.getters;window.stopPatchingIcon&&clearTimeout(window.stopPatchingIcon),window.stopPatchingIcon=setTimeout(function(){t.patching=!1}.bind(t),300)},startPatching:function(e){var t=e.state;e.commit,e.dispatch,e.getters;window.stopPatchingIcon&&clearTimeout(window.stopPatchingIcon),t.patching=!0},deleteItemDialogue:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.id;o=o||t.selection.selectedId,n("popout",{id:o,type:"confirm-delete"})},popup:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id,o=n.type;i=i||t.selection.selectedId;var r=t.nodes[i];t.popups.filter(function(e){return e.item.id===i})[0]||t.popups.push({item:r,type:o,timeout:!0,time:10})},sendFlash:function(e){var t=(e.state,e.commit),n=(e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});t("pushFlash",{type:n.type,msg:n.msg})},popout:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id,o=n.type;if(i=i||t.selection.selectedId){var r=t.nodes[i];"timer"==o&&(t.popouts.timer.push(r),Vue.nextTick(function(){console.log("emitting playTimer on Vue.nextTick"),Vue.bus.$emit("playTimer",r)})),"confirm-delete"==o&&t.popouts.delete.push(r)}},addTimer:function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.selection.selectedId}),o=i.id;n("popout",{id:void 0===o?t.selection.selectedId:o,type:"timer"})},clipboardSuccess:function(e){e.dispatch,e.state,e.getters},clipboardError:function(e){e.dispatch,e.state,e.getters},copyProgrammatic:function(e){var t=e.dispatch,n=e.state,i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:n.selection.selectedId},r=o.id,d=void 0===r?n.selection.selectedId:r,a=i.clipboardText(d),s=document.createElement("textarea");s.style.position="fixed",s.style.top=0,s.style.left=0,s.style.width="2em",s.style.height="2em",s.style.padding=0,s.style.border="none",s.style.outline="none",s.style.boxShadow="none",s.style.background="transparent",s.value=a,document.body.appendChild(s),s.select();try{var l=document.execCommand("copy"),c=l?"successful":"unsuccessful";t("clipboardSuccess"),console.log("Copying text command was "+c)}catch(e){t("clipboardError"),console.log("Oops, unable to copy")}document.body.removeChild(s)}},r()(i,"prepareTag",function(e){var t=e.state;t.newTag&&(t.newItem.preparedTags.push(t.newTag),t.newTag=null)}),r()(i,"blurOnEditOrAdd",function(e){var t=e.dispatch,n=e.commit,i=e.state,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{field:null},d=r.field;if(i.addingNewUnder){var a=i.newItem.planned_time?parseFloat(i.newItem.planned_time):0;n("newItem/updateState",{planned_time:a})}if(!i.blockBlur){if(o.mobile&&"add-tag"==d){if(i.editingItem)return void t("tagItem",{id:i.editingItem,tags:i.newTag});if(i.addingNewUnder)return void t("prepareTag")}o.mobile||setTimeout(function(){"INPUT"!=document.activeElement.nodeName&&"TEXTAREA"!=document.activeElement.nodeName&&"A"!=document.activeElement.nodeName&&"BUTTON"!=document.activeElement.nodeName&&(i.editingItem&&(console.log("blurring on edit"),t("doneEdit")),i.editingItemTags&&(console.log("blurring on edit tags"),n("updateState",{editingItemTags:null})),i.addingNewUnder&&(console.log("bluring on Add New"),t("cancelAddNew")))},50)}}),r()(i,"doneEditOrCancelNew",function(e){var t=e.state,n=e.dispatch;t.editingItem&&(console.log("blurring on edit"),n("doneEdit")),t.addingNewUnder&&(console.log("bluring on Add New"),n("cancelAddNew"))}),r()(i,"focusElement",function(e,t){var n=(e.state,t.el);document.querySelector(n).focus()}),r()(i,"filterItems",function(e){var t=e.state,n=(e.commit,e.dispatch),i=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=i.keyword,r=i.value,d=i.event;if(!t.editingItem){var a=null;d&&(d.preventDefault(),d.ctrlKey||d.metaKey?a="AND":d.altKey&&(a="NOT")),"journal"!=o||t.fetchedDone||n("fetchDone",{tags:null,operator:a}),n("selection/addKeywords",{keyword:o,value:r,operator:a})}}),r()(i,"removeFilter",function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.tag;t.selection.hiddenTags=t.selection.hiddenTags.filter(function(e){return e!==i})}),r()(i,"test",function(e){var t=(e.state,e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});t.id;document.querySelectorAll(".tag-menu a").forEach(function(e){return alert(u()(e.style.color))})}),r()(i,"alert",function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=(e.state,e.commit,e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=t.value;alert(n)})),i)},162:function(e,t,n){"use strict";var i=n(179),o=n.n(i),r=n(76),d=n.n(r),a=n(7),s=n.n(a),l=n(180),c=n.n(l),u=n(40),f=n(29),h=n(11),m=n(136);t.a={totalPlannedMin:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id,i=e.nodes[n];if(!i)return 0;var o=i.planned_time?parseFloat(i.planned_time):0,r=t.getAllChildrenIds(n);if(!r||!r.length)return o;var d=r.reduce(function(t,n){var i=e.nodes[n],o=i?i.planned_time:0;return t+parseFloat(o)},o);return d?parseFloat(d):0}},totalUsedSec:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id,i=void 0,o=void 0;if("object"===(void 0===n?"undefined":c()(n))&&n.journalDate?(i=n,o=i.children):(i=e.nodes[n],o=t.getAllChildrenIds(n)),!i)return 0;var r=i.used_time?parseFloat(i.used_time):0;if(!o||!o.length)return r;var d=o.reduce(function(t,n){var i=e.nodes[n],o=i?i.used_time:0;return t+parseFloat(o)},r);return d||0}},totalUsedMin:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return Math.floor(t.totalUsedSec(n)/60)}},totalUsedHourMin:function(e,t){return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return n.i(m.c)(t.totalUsedSec(i))}},totalPlannedSec:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return 60*t.totalPlannedMin(n)}},totalPlannedHour:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return t.totalPlannedMin(n)/60}},totalMinLeft:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return t.totalPlannedMin(n)-t.totalUsedMin(n)}},totalSecLeft:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return t.totalPlannedSec(n)-t.totalUsedSec(n)}},totalHourMinLeft:function(e,t){return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return n.i(m.c)(t.totalSecLeft(i))}},secLeft:function(e,t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id,n=e.nodes[t];return n?60*n.planned_time-n.used_time:0}},minLeft:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return t.secLeft(n)/60}},totalTimeDifferentFromParent:function(e,t){return function(n){var i=e.nodes[n];return i?!i.parent_id||t.totalPlannedSec(n)!=t.totalPlannedSec(i.parent_id):0}},oS:function(e,t){return f.i.is.platform},hasTag:function(e,t){return function(t,n){var i=e.nodes[t];if(!i)return console.log("[hasTag(id, tags)] what is state shit... id:"+t),!1;if(!i.tagged||!i.tagged.length)return!1;var o=void 0;return Array.isArray(n)||(n=[n]),n.forEach(function(e){e=h.e.tagNameToSlug(e),i.tagged.find(function(t){return t.tag_slug==e})&&(o=!0)}),o}},hasParentWithTag:function(e,t){return function(n,i){if(!n)return!1;var o=(e.nodes[n],e.nodes[n].parent_id);return!!o&&(!!e.nodes[o]&&(!!t.hasTag(o,i)||t.hasParentWithTag(o,i)))}},parentIdWithTag:function(e,t){return function(n,i){var o=e.nodes[n];console.log("id & body = "+o.id+" - "+o.body);var r=e.nodes[n].parent_id;if(!r)return!1;var d=t.hasTag(r,i);return console.log("parentHasTag"),console.log(d),d?r:t.parentIdWithTag(r,i)}},tagsArray:function(e,t){return function(t){var n=e.nodes[t];return n?n.tagged.map(function(e){return e.tag_name}):[]}},siblingIndex:function(e,t){return function(t){var n=e.nodes[t];if(!n)return!1;var i=n.parent_id;return!(!i||!e.nodes[i])&&e.nodes[i].children_order.indexOf(t)}},olderSiblingId:function(e,t){return function(n){var i=e.nodes[n];if(i){var o=i.parent_id;if(o){var r=e.nodes[o].children_order;if(r.length<=1||0==t.siblingIndex(n))return o;var d=r.indexOf(n);return e.nodes[o].children_order[d-1]}}}},nextItemId:function(e,t){return function(n,i){if(n){var o=e.nodes[n];if(o){var r=void 0;if(t.isTopLvlItemInFilteredRoot(n)&&!o.show_children||"journal"==e.selection.view){var d=t.childrenOrder(e.root.id).indexOf(n);return d+1==t.childrenOrder(e.root.id).length?t.childrenOrder(e.root.id)[0]:t.childrenOrder(e.root.id)[d+1]}return o.show_children&&o.children.length?(r=o.children_order[0],t.hiddenItemIds.includes(r)&&(r=t.nextItemRecursion(r))):r=t.nextItemRecursion(n),r}}}},nextSiblingOrParentsSiblingId:function(e,t){return function(n){var i=e.nodes[n];if(i){var o=i.parent_id;if(o){var r=e.nodes[o].children_order,d=t.siblingIndex(n)+1;return d==r.length?t.nextSiblingOrParentsSiblingId(o):r[d]}}}},getLastChildId:function(e,t){return function(t){var n=e.nodes[t],i=n.children.length;if(i&&n.show_children){return n.children[i-1].id}return t}},getDeepestLastChildId:function(e,t){return function(n){var i=t.getLastChildId(n),o=e.nodes[i];return o.children.length&&o.show_children?t.getDeepestLastChildId(i):i}},itIsADeepestChild:function(e,t){return function(n){return n?!!t.childrensDeepestChildren(e.root.id).map(function(e){return e.deepestChild}).includes(n):void console.log("you need an ID")}},findDeepestVisibleChild:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selection.selectedId,i=e.nodes[n],o=i.children.filter(function(e){return!t.hiddenItemIds.includes(e.id)});if(!o.length)return n;var r=o[o.length-1].id;return t.findDeepestVisibleChild(r)}},isFirstItem:function(e,t){return function(e){return!t.noItems&&0==t.siblingIndex(e)}},childrensDeepestChildren:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root.id;return t.visibleDirectChildren(n).map(function(e){return{id:e.id,deepestChild:t.findDeepestVisibleChild(e.id)}})}},deepestChild:function(e,t){return function(n){return t.childrensDeepestChildren(e.root.id).find(function(e){return e.id==n}).deepestChild}},topLvlParentOfDeepestChild:function(e,t){return function(n){return t.childrensDeepestChildren(e.root.id).find(function(e){return e.deepestChild==n}).id}},prevItemId:function(e,t){return function(n,i){if(!n)return!1;var o=e.nodes[n];if(0==o.depth)return!1;var r=o.parent_id,d=void 0,a=void 0,s=t.childrenOrder(e.root.id);return t.isTopLvlItemInFilteredRoot(n)||"journal"==e.selection.view?(a=s.indexOf(n),0==a?d="journal"==e.selection.view?s[s.length-1]:t.deepestChild(s[s.length-1]):(d=s[a-1],"journal"!=e.selection.view&&(d=t.deepestChild(d)))):(a=t.siblingIndex(n),s[0]==n?d=t.deepestChild(s[s.length-1]):0==a?d=r:(d=e.nodes[r].children_order[a-1],d=t.getDeepestLastChildId(d))),t.hiddenItemIds.includes(d)?t.prevItemId(d):d}},nextItemRecursion:function(e,t){return function(n){var i=t.siblingIndex(n)+1,o=e.nodes[n],r=o.parent_id;if(t.itIsADeepestChild(n)){var d=t.topLvlParentOfDeepestChild(n),a=t.childrenOrder(e.root.id),s=a.indexOf(d);if(s+1==a.length){var l=a[0];return l==n?null:l}return a[s+1]}if(i==e.nodes[r].children_order.length){if(r==e.root.id)return;return t.nextItemRecursion(r)}var c=e.nodes[r].children_order[i];return t.hiddenItemIds.includes(c)?t.nextItemRecursion(c):c}},isTopLvlItemInFilteredRoot:function(e,t){return function(n){return(!t["selection/nothingSelected"]||"tree"!=e.selection.view)&&(n==e.root.id||!!t.childrenOrder(e.root.id).includes(n))}},hasParentDueToday:function(e,t){return function(i){i=i||e.selection.selectedId;var o=e.nodes[i];if(!o.parent_id)return!1;var r=e.nodes[o.parent_id];return!!r&&(n.i(u.c)(new Date(r.due_date),new Date)<=0||t.hasParentDueToday(o.parent_id))}},isDueToday:function(e,t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selection.selectedId,i=e.nodes[t];return!!i&&n.i(u.c)(new Date(i.due_date),new Date)<=0}},isProject:function(e,t){return function(t){return!!t&&":"==e.nodes[t].body.slice(-1)}},itemTagArray:function(e,t){return function(t){return e.nodes[t].tagged.map(function(e){return e.tag_name})}},allChildrenDone:function(e,t){return function(t){var n=e.nodes[t].children;if(!n.length)return!1;var i=n.reduce(function(e,t){var n=t.done?1:0;return h.e.AplusB(n,e)},0);return n.length==i}},getAllChildrenIds:function(e,t){return function(e){var n=[];return t.getAllChildrenIdsRecursive(e,n),n}},getAllChildrenIdsRecursive:function(e,t){return function(n,i){var o=e.nodes[n];o&&Array.isArray(o.children)&&o.children.length&&(o.children_order.forEach(function(e){i.push(e)}),o.children_order.forEach(function(e){return t.getAllChildrenIdsRecursive(e,i)}))}},calTotalPlannedTime:function(e,t){return function(t){var n=e.nodes[t],i=void 0;return i=Array.isArray(n.children)&&n.children.length?n.children.reduce(function(e,t){var n=t.totalPlannedTime?t.totalPlannedTime:t.planned_time;return e+parseFloat(n)},n.done&&"journal"!=e.selection.view?0:parseFloat(n.planned_time)):n.done&&"journal"!=e.selection.view?0:parseFloat(n.planned_time),parseFloat(i)}},calTotalUsedTime:function(e,t){return function(t){var n=e.nodes[t];if(!n)return 0;var i=void 0;return i=Array.isArray(n.children)&&n.children.length?n.children.reduce(function(e,t){var n=t.totalUsedTime?t.totalUsedTime:t.used_time;return e+parseFloat(n)},n.done&&"journal"!=e.selection.view?0:parseFloat(n.used_time)):n.done&&"journal"!=e.selection.view?0:parseFloat(n.used_time),parseFloat(i)}},checkValParentTree:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){return function(n,i){var o=e.nodes[n].parent_id;if(console.log("checkValParentTree pId: "+checkValParentTree),!o)return!1;var r=e.nodes[o].item[i];return console.log("checkValParentTree checkVal: "+r),r||t.checkValParentTree(o,i)}}),getParentsAsArray:function(e,t){return function(e){var n=[];return t.getParentsRecursive(e,n),n.reverse().shift(),n}},getParentsRecursive:function(e,t){return function(n,i){var o=e.nodes[n].parent_id;o&&(i.push(e.nodes[o].body),t.getParentsRecursive(o,i))}},setDefaultItemValues:function(e,t){return function(e){return e.depth=Number(e.depth),null==e.show_children&&(e.show_children=1),e.children||(e.children=[]),e.due_date||(e.due_date="0000-00-00 00:00:00"),e.done_date||(e.done_date="0000-00-00 00:00:00"),e.done||(e.done=!1),e.used_time||(e.used_time=0),e.tagged||(e.tagged=[]),e.children_order?"string"==typeof e.children_order&&(e.children_order=e.children_order.split(",").map(Number)):e.children_order=[],e}},countChildren:function(e,t){return function(e){return e&&e.children?t.flattenTree(e.children).length:0}},countDoneChildren:function(e,t){return function(e){return e.children?t.flattenTree(e.children).filter(function(e){return e.done}).length:0}},language:function(e,t){return e.setLanguage?e.setLanguage:defaultLanguage||"en"},text:function(e,t){return e.languageContents[t.language]},desktop:function(e,t){return f.i.is.desktop},mobile:function(e,t){return!!e.manualMobile||f.i.is.mobile},mobileSmall:function(e,t){if(window.innerWidth<385)return!0},noItems:function(e,t){return!t.visibleDirectChildren(e.root.id).length||1==t.visibleDirectChildren(e.root.id).length&&t.visibleDirectChildren(e.root.id)[0].id==e.root.id},filteredItems:function(e,t){return"tree"==e.selection.view?t.filteredItemsTree:"journal"==e.selection.view?t.filteredItemsJournal:void 0},filteredItemsJournal:function(e,t){if("journal"!=e.selection.view)return[];var i={};t.filteredItemsFlat.forEach(function(e){if(e.done){var t=n.i(u.a)(e.done_date,"YYYY-MM-DD");i[t]||(i[t]=[]),i[t].push(e)}});var o=[];return s()(i).forEach(function(e){var r={done_date:e,children:n.i(h.l)(i[e],"parents_bodies"),depth:0,journalDate:!0};r=t.setDefaultItemValues(r),o.push(r)}),o=n.i(h.l)(o,"done_date","desc")},journalDates:function(e,t){return s()(t.filteredItemsJournal)},filteredItemsFlat:function(e,t){var i=n.i(h.k)(e.nodes).filter(function(i){var o=e.selection.tags.every(function(e){return t.hasTag(i.id,e)}),r=e.selection.hiddenTags.some(function(e){return t.hasTag(i.id,e)}),d="journal"!=e.selection.view||i.done,a=!0;if(t["selection/dueTodayFiltered"]){a=!1;(n.i(u.c)(new Date(i.due_date),new Date)<=0||t.hasParentDueToday(i.id))&&(a=!0);n.i(u.c)(new Date(i.done_date),new Date)<=1&&(a=!1)}if(o&&!r&&d&&a)return!0});return"journal"==e.selection.view&&(i=n.i(h.m)(i,"done_date","parents_bodies","desc","asc")),i},filteredItemsTree:function(e,t){if(1==n.i(h.k)(e.nodes).length&&n.i(h.k)(e.nodes)[0].id==e.root.id)return n.i(h.k)(e.nodes);var i=void 0;if(t["selection/noFilterOrTag"]||(i=n.i(h.k)(e.nodes).filter(function(i){var o=!0,r=void 0;if(e.selection.tags.length){var d=e.selection.tags.every(function(e){return t.hasTag(i.id,e)}),a=e.selection.hiddenTags.some(function(e){return t.hasTag(i.id,e)});r=e.selection.tags.every(function(e){return t.hasParentWithTag(i.id,e)}),o=!(!d||r||a)}var s=!0,l=void 0;if(t["selection/dueTodayFiltered"]){var c=t.isDueToday(i.id);l=t.hasParentDueToday(i.id),s=!(!c&&!l)}var f=void 0;if(t["selection/doneFiltered"])f=!!i.done;else{var h=n.i(u.c)(new Date(i.done_date),new Date);f=!i.done||h<=-1}var m=!0;e.selection.tags.length&&t["selection/dueTodayFiltered"]&&(m=!(!s||!o||r&&l));var p=e.selection.hiddenItems.every(function(e){return e!=i.id});return!!(o&&s&&f&&m&&p)})),t["selection/noFilterOrTag"]){i=e.root.children;var o=e.root.children_order;o instanceof Array&&o.length&&(i=o.map(function(e){return i.find(function(t){return t.id===e})}))}return t["selection/dueTodayFiltered"]&&(i=n.i(h.l)(i,"done_date")),i=i.filter(function(e){return void 0!==e})},allVisibleChildItems:function(e,t){return function(e){var n=t.visibleDirectChildren(e);return t.flattenTree(n).filter(function(e){return!t.hiddenItemIds.includes(e.id)})}},visibleDirectChildren:function(e,t){return function(n){if(n==e.root.id)return t.filteredItems.filter(function(t){return t.id!=e.root.id});var i=e.nodes[n];return i&&i.children.length?i.children.filter(function(e){return!t.hiddenItemIds.includes(e.id)}):[]}},flattenTree:function(e,t){return function(e){var n=[];return e.forEach(function(e){n.push(e),e.children.length&&Array.prototype.push.apply(n,t.flattenTree(e.children))}),n}},childrenOrder:function(e,t){return function(n){var i=t.visibleDirectChildren(n);return"journal"==e.selection.view&&n==e.root.id&&(i=i.reduce(function(e,t){return e.concat(t.children)},[])),i.map(function(e){return e.id})}},clipboardText:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selection.selectedId;n=n||e.root.id;var i=e.nodes[n],o=void 0,r=void 0,d=0;return t["selection/dueTodayFiltered"]?r=!0:d=parseFloat(i.depth),i=e.nodes[n],o=t.allVisibleChildItems(n),i?o.reduce(function(e,t){return e+"\n"+"　　".repeat(r?0:parseFloat(t.depth)-d)+"・"+t.body},""+i.body):""}},clipboardTextFromItem:function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selection.selectedId,i=void 0,o=void 0,r=void 0,d=0;return"object"===(void 0===n?"undefined":c()(n))?(i=n,o=i.children,r=!0):(i=e.nodes[n],o=t.allVisibleChildItems(n),d=parseFloat(i.depth)),i?o.reduce(function(e,t){return e+"\n"+"　　".repeat(r?0:parseFloat(t.depth)-d)+"・"+t.body},""+i.body):""}},clipboardTextJournal:function(e,t){return function(e){var i=t.totalUsedMin(e)?"\n"+t.text.menu.usedTime+": "+n.i(m.c)(t.totalUsedSec(e)):"",o=t.journalDate(e)+"\n=========="+i;return e.children.reduce(function(e,t){var n=t.completion_memo?"\n　　"+t.completion_memo:"";return e+(e.includes("【"+t.parents_bodies+"】")?"":"\n【"+t.parents_bodies+"】")+"\n・"+t.body+n},o)}},journalDate:function(e,t){return function(t){return!(!t||"journal"!=e.selection.view||!t.journalDate)&&t.done_date}},hiddenItemIds:function(e,t){return n.i(h.k)(e.nodes).filter(function(n){if(e.selection.hiddenTags.some(function(e){return t.hasTag(n.id,e)}))return!0}).map(function(e){return e.id})},allTagsComputed:function(e,t){var i=performance.now();if(t.noItems)return[];var o=[],r=t.filteredItemsFlat.length?t.filteredItemsFlat:[];if(!r.length)return[];r.forEach(function(e){e.tagged.forEach(function(e){if(e.tag&&e.tag.name){o.find(function(t){return t.name==e.tag.name}.bind(e))||o.push(e.tag)}}.bind(o))}.bind(o)),o=n.i(h.l)(o,"name");var d=performance.now();return console.log("Call to allTagsComputed took "+(d-i)+" milliseconds."),o},allTagsComputed_2:function(e,t){var i=performance.now();if(t.noItems)return[];var o=[],r=t.filteredItemsFlat.length?t.filteredItemsFlat:[];if(console.log("allTagsComputed_2"),!r.length)return[];o=r.reduce(function(e,t){var n=t.tagged.map(function(e){return e.tag}).filter(function(e){return e});return e.concat(n)},[]),o=n.i(h.n)(o),o=n.i(h.l)(o,"name");var d=performance.now();return console.log("Call to allTagsComputed_2 took "+(d-i)+" milliseconds."),o},allTagsComputed_3:function(e,t){var i=performance.now();if(t.noItems)return[];var r=new d.a,a=t.filteredItemsFlat.length?t.filteredItemsFlat:[];if(!a.length)return[];a.forEach(function(e){e.tagged.length&&e.tagged.forEach(function(e){e&&r.add(e.tag)})}.bind(r)),r=[].concat(o()(r)),r=n.i(h.n)(r),r=n.i(h.l)(r,"name");var s=performance.now();return console.log("Call to allTagsComputed_3 took "+(s-i)+" milliseconds."),r},allTagsComputed_1b:function(e,t){var i=performance.now();if(t.noItems)return[];var o=[],r=t.filteredItemsFlat.length?t.filteredItemsFlat:[];if(!r.length)return[];r.forEach(function(e){e.tagged.forEach(function(e){if(e.tag&&e.tag.name){o.find(function(t){return t.name==e.tag.name}.bind(e))||o.push(e.tag)}}.bind(o))}.bind(o)),o=n.i(h.l)(o,"name");var d=performance.now();return console.log("Call to allTagsComputed 1b took "+(d-i)+" milliseconds."),o},itemAmount:function(e,t){return t.noItems?0:(t.filteredItemsFlat.length?t.filteredItemsFlat:[]).length-1},doneItemAmount:function(e,t){return t.noItems?0:(t.filteredItemsFlat.length?t.filteredItemsFlat:[]).filter(function(e){return e.done}).length},lastItems:function(e,t){if(t.noItems)return[];var n=t.topLvlItems[t.topLvlItems.length-1];return[n,t.findDeepestVisibleChild(n)]},firstItem:function(e,t){return t.noItems?null:t.topLvlItems[0]},topLvlItems:function(e,t){return t.noItems?[]:(console.log("getters.filteredItemsTree in toplvlitems"),console.log(t.filteredItemsTree),t.filteredItemsTree.map(function(e){return e.id}))}}},163:function(e,t,n){"use strict";t.a={copyClipboard:{mac:"",win:"",name:{en:"copy",ja:"コピー"},guide:{en:"Copy to clipboard",ja:"クリップボードにコピー"},popmenu:{en:"Copy to clipboard",ja:"クリップボードにコピー"},success:{en:"Copied successfully! Now go paste!",ja:"コピーしました！どこかにペーストしましょう！"},error:{en:"There was an error copy'ing! Please let <a href='mailto:mesqueeb@gmail.com'>Luca Ban</a> know!",ja:"コピーしようとしたけど、エラーが起きました！<a href='mailto:mesqueeb@gmail.com'>バン・ルカへのお知らせ</a>ください！"}},delete:{mac:"⌫",win:"⌫",name:{en:"delete",ja:"削除"},guide:{en:"Delete item",ja:"削除"},popmenu:{en:"Delete item",ja:"削除"}},setToday:{mac:"T",win:"T",name:{en:"do today",ja:"今日やる"},guide:{en:"Do <u>T</u>oday",ja:"今日に設定"},popmenu:{en:"Do <u>T</u>oday",ja:"今日に設定"}},setTomorrow:{mac:"-",win:"-",name:{en:"do tomorrow",ja:"明日やる"},guide:{en:"Do tomorrow",ja:"明日に設定"},popmenu:{en:"Do tomorrow",ja:"明日に設定"}},timer:{mac:"S",win:"S",name:{en:"timer",ja:"タイマー"},guide:{en:"<u>S</u>topwatch / Timer",ja:"ストップウォッチ / タイマー"},popmenu:{en:"",ja:""}},indent:{mac:"tab",win:"tab",name:{en:"",ja:""},guide:{en:"Indent item",ja:"アイテムを右へ"},popmenu:{en:"",ja:""}},add:{mac:"enter",win:"enter",name:{en:"",ja:""},guide:{en:"Add item",ja:"アイテムを追加"},popmenu:{en:"",ja:""}},edit:{mac:"⌘ enter",win:"ctrl enter",name:{en:"edit",ja:"編集"},guide:{en:"Edit item",ja:"アイテムを編集"},popmenu:{en:"Edit item",ja:"アイテムを編集"}},editTag:{mac:"shift T",win:"shift T",name:{en:"",ja:""},guide:{en:"Edit tags",ja:"タグを編集"},popmenu:{en:"",ja:""}},hideTag:{mac:"alt click",win:"alt click",name:{en:"",ja:""},guide:{en:"Hide tag",ja:"タグのアイテムを非表示"},popmenu:{en:"",ja:""}},move:{mac:"⌘ ↑↓",win:"ctrl ↑↓",name:{en:"",ja:""},guide:{en:"Move item up/down",ja:"アイテムを上下へ移動"},popmenu:{en:"",ja:""}},duplicate:{mac:"⌘ shift D",win:"ctrl shift D",name:{en:"",ja:""},guide:{en:"Duplicate item",ja:"アイテムを複製"},popmenu:{en:"",ja:""}}}},164:function(e,t,n){"use strict";var i=n(11),o=n(171),r=n(65),d=n.n(r);t.a={state:{},actions:{login:function(e,t){var n=e.commit,i=e.dispatch;e.getters,e.rootState;n("updateState",{loading:!0}),d.a.post(apiBaseURL+"auth",t).then(function(e){var t=e.data;i("setToken",{token:t.token}),i("fetchListo"),router.push("/")})},setToken:function(e,t){var n=(e.state,t.token);window.axios.defaults.headers.common={"X-Requested-With":"XMLHttpRequest",Authorization:"Bearer "+n},console.log("token set!")},fetchListo:function(e){var t=e.commit,i=e.dispatch;t("updateState",{loading:!0}),console.log("start fetching all items"),console.log(d.a.defaults.headers.common),d.a.get(apiBaseURL+"items").then(function(e){var r=e.data;console.log("fetched all items");var d=n.i(o.a)(r);t("updateState",{source:d.source}),t("updateState",{orphans:d.orphans}),t("updateState",{nodes:d.nodes}),t("updateState",{root:d.root}),i("sortAllChildren"),t("updateState",{loading:!1}),i("getUser")}).catch(function(e){console.log("ERROR: "+e)})},getUser:function(e){var t=e.dispatch,n=e.commit;d.a.get(apiBaseURL+"user").then(function(e){var i=e.data;console.log(i),n("updateUser",{user:i.user}),t("sendFlash",{msg:"Hello "+i.user.name+"!"})})},patch:function(e){var t=e.commit,o=e.dispatch,r=e.getters,a=e.rootState,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=s.id,c=s.field,u=s.value;if(!a.user.user)return void console.log("not Logged in");o("startPatching");var f={},h=u||a.nodes[l][c];"children_order"==c&&(h=n.i(i.h)(h)),f[c]=h,d.a.patch(apiBaseURL+"items/"+l,f,{method:"PATCH"}).then(function(e){console.log("patched "+l+"["+a.nodes[l].body+"]."+c+" = "+f[c]),o("stopPatching")},function(e){t("updateState",{patching:"error"});var n=r.text.flashes.ajaxError;console.log(n),o("sendFlash",{type:"ajaxError",msg:n})})},patchTag:function(e){var t=e.rootState,o=e.dispatch,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.id,s=r.tags,l=r.requestType;if(!t.user.user)return void console.log("not Logged in");if(s){if(o("updateItemTagsDom",{id:a,tags:s,requestType:l}),Array.isArray(s)){if(s=n.i(i.i)(s),!s.length)return}else if(!s.replace(/\s/g,"").length)return;o("startPatching");var c={};c.tags=s,c.type=l,d.a.patch(apiBaseURL+"itemtags/"+a,c,{method:"PATCH"}).then(function(e){e.data.tags;console.log("tagged ["+t.nodes[a].body+"] with: "+e.data.tags+";"),console.log(e),d.a.get(apiBaseURL+"itemtags/"+a,{type:"tags"}).then(function(e){t.nodes[a].tagged=e.data,console.log("updatedTagList of ["+t.nodes[a].body+"] with: "+e.data.map(function(e){return e.tag_name})+";")}),o("stopPatching")})}},patchDueDate:function(e){var t=e.dispatch,n=e.rootState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id,r=i.duedate;return n.user.user?(t("startPatching"),"0000-00-00 00:00:00"==r?void d.a.patch(apiBaseURL+"items/"+o,{due_date:r}).then(function(e){t("stopPatching")}):(r=new Date(r),console.log("PatchDueDate: "+r),void d.a.patch(apiBaseURL+"items/"+o,{due_date:r}).then(function(e){t("stopPatching")}))):void console.log("not Logged in")},patchDone:function(e){var t=e.rootState,n=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;if(!t.user.user)return void console.log("not Logged in");n("startPatching");var r=void 0,a=t.nodes[o].done;r=a?new Date:"0000-00-00 00:00:00",d.a.patch(apiBaseURL+"items/"+o,{done:a,done_date:r}).then(function(e){n("stopPatching")})},deleteItemApi:function(e){var t=e.rootState,n=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.idOrArray;if(!t.user.user)return void console.log("not Logged in");if(n("startPatching"),Array.isArray(o)&&o.length){o.forEach(function(e){n("deleteItemApi",{idOrArray:e})})}else{var r=o;if(!r)return;var a=t.nodes[r];d.a.delete(apiBaseURL+"items/"+r).then(function(e){console.log("deleted: "+r+"["+a.body+"]"),n("stopPatching")})}},fetchDone:function(e){var t=e.rootState,n=(e.dispatch,e.getters),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.tags,i.operator;if(!t.user.user)return void console.log("not Logged in");t.loading=!0,d.a.get(apiBaseURL+"items/fetchdone").then(function(e){t.fetchedDone=!0,console.log("fetched Done");var i=e.data;if(console.log(i),!i.length)return console.log("no done items..."),void(t.loading=!1);i.forEach(function(e){e=n.setDefaultItemValues(e),t.nodes[e.id]||(t.nodes[e.id]=e)}),t.selection.view=null,t.selection.view="journal",t.loading=!1})},postNewItem:function(e){var t=e.rootState,o=e.dispatch,r=e.getters,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.newItem,l=a.index,c=a.addNextItemAs,u=a.addTags,f=a.duplication;if(!t.user.user)return void console.log("not Logged in");o("startPatching"),s.children_order&&(s.children_order=n.i(i.h)(s.children_order));var h=s;d.a.post(apiBaseURL+"items",h).then(function(e){var t=e.data;console.log("starting dom update..."),console.log("Index: "),console.log(l),o("addItem",{item:t,index:l,addNextItemAs:c,addTags:u,duplication:f}),o("stopPatching")},function(e){t.patching="error";var n=r.text.flashes.ajaxError;console.log(n),o("sendFlash",{type:"ajaxError",msg:n})})},patchRootChildrenOrderWithFilter:function(e){var t=e.rootState,n=(e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id;if(!t.user.user)return void console.log("not Logged in");d.a.get(apiBaseURL+"items/"+t.root.id).then(function(e){var n=e.data.children_order;n=n+","+i,d.a.patch(apiBaseURL+"items/"+t.root.id,{children_order:n}).then(function(e){var t=e.data.children_order;console.log("newRootChildrenOrder = "+t)})})}},getters:{someGetter:function(e,t,n,i){return function(e){t.someOtherGetter,i.someOtherGetter}}}}},165:function(e,t,n){"use strict";var i=n(7),o=n.n(i),r=n(11);t.a={namespaced:!0,state:{body:"",due_date:"0000-00-00 00:00:00",done_date:"0000-00-00 00:00:00",done:!1,planned_time:"",preparedTags:[],children:[],children_order:[],newItem:!0},mutations:{updateState:function(e,t){var n=t.field,i=t.value;if(n||i||(n=o()(t).filter(function(e){return"id"!=e})[0],i=t[n]),t.id)return void(e.nodes[t.id][n]=i);e[n]=i},deleteTag:function(e,t){var n=t.tag;e.preparedTags=e.preparedTags.filter(function(e){return e!=n})}},actions:{someAction:function(e){var t=(e.state,e.rootState,e.getters),n=e.rootGetters,i=e.dispatch,o=e.commit,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.id;t.someOtherGetter,n.someOtherGetter,i("someOtherAction"),i("someOtherAction",null,{root:!0}),o("someMutation"),o("someMutation",null,{root:!0})}},getters:{someGetter:function(e,t,n,i){return function(e){t.someOtherGetter,i.someOtherGetter}},parent_id:function(e,t,n,i){return n.addingNewUnder&&n.addingNewUnder!=n.root.id?n.addingNewAsChild||n.addingNewAsFirstChild?n.addingNewUnder:n.nodes[n.addingNewUnder].parent_id:n.root.id},preparedPlusComputedTags:function(e,t,i,o){var d=e.preparedTags,a=o.tagsArray(t.parent_id);return d=d.concat(a),d=d.concat(i.selection.tags.map(function(e){return r.e.tagSlugToName(e)})),d=n.i(r.g)(d),d.sort()}}}},166:function(e,t,n){"use strict";var i=n(7),o=n.n(i),r=n(29),d=r.k.getDateDiff;t.a={namespaced:!0,state:{selectedId:null,lastSelectedId:null,filter:{dueDate:{from:null,to:null},doneDate:{from:null,to:null}},tags:[],hiddenTags:[],hiddenItems:[],hiddenBookmarks:[],view:"tree"},mutations:{clear:function(e){e.filter={dueDate:{from:null,to:null},doneDate:{from:null,to:null}},e.tags=[],e.hiddenTags=[],e.hiddenItems=[],e.hiddenBookmarks=[]},clearTags:function(e){e.hiddenTags=[],e.tags=[]},clearFilters:function(e){e.filter={dueDate:{from:null,to:null},doneDate:{from:null,to:null}},e.hiddenBookmarks=[]},updateState:function(e,t){var n=t.field,i=t.value;if(n||i||(n=o()(t).filter(function(e){return"id"!=e})[0],i=t[n]),t.id)return void(e.nodes[t.id][n]=i);e[n]=i}},actions:{addKeywords:function(e,t){var n=e.state,i=(e.rootState,e.getters,e.rootGetters),o=(e.dispatch,e.commit),r=t.keyword,d=t.value,a=t.operator;if("tag"==r)if("NOT"==a){if(n.hiddenTags.includes(d))return;n.hiddenTags.push(d),n.tags=n.tags.filter(function(e){return e!==d})}else n.tags.includes(d)?n.tags=n.tags.filter(function(e){return e!==d}):n.hiddenTags.includes(d)?n.hiddenTags=n.hiddenTags.filter(function(e){return e!==d}):(a||o("clearTags"),n.tags.push(d));else{if(a&&"all"!=r||o("clearFilters"),"all"==r&&(n.view="tree"),"NOT"==a&&"journal"==r)return void n.hiddenBookmarks.push(r);"journal"==r?n.view="journal":d&&(n.view="tree"),"duedate"==r&&(n.filter.dueDate.to=d)}Vue.nextTick(function(){i.filteredItemsFlat.map(function(e){return e.id}).includes(n.selectedId)||(n.selectedId=null)})}},getters:{nothingSelected:function(e,t){return t.noTagsSelected&&t.noFiltersSelected&&!e.hiddenItems.length&&!e.hiddenBookmarks.length},noFilterOrTag:function(e,t){return t.noTagsSelected&&t.noFiltersSelected},noTagsSelected:function(e){return!e.tags.length&&!e.hiddenTags.length},noFiltersSelected:function(e,t){return!t.dueDateFiltered&&!t.doneFiltered},dueDateFiltered:function(e){return null!=e.filter.dueDate.from||null!=e.filter.dueDate.to},doneFiltered:function(e){return null!=e.filter.doneDate.from||null!=e.filter.doneDate.to},dueTodayFiltered:function(e){return 0==d(e.filter.dueDate.to,new Date,"days")},getHiddenItemsTotalUsedTime:function(e,t){return e.hiddenItems.length?e.hiddenItems.reduce(function(t,n){var i=e.nodes[n];if(!i)return t;var o=i.used_time;return console.log(o),t+o},0):0},getHiddenItemsTotalPlannedTime:function(e,t){return e.hiddenItems.length?e.hiddenItems.reduce(function(t,n){var i=e.nodes[n];if(!i)return t;var o=i.planned_time;return console.log(o),t+o},0):0}}}},167:function(e,t,n){"use strict";var i=n(7),o=n.n(i);t.a={state:{user:null},mutations:{updateUser:function(e,t){var n=t.field,i=t.value;n||i||(n=o()(t)[0],i=t[n]),e[n]=i}},actions:{},getters:{}}},168:function(e,t,n){"use strict";var i=n(7),o=n.n(i);t.a={state:{plannedDurations:[10,15,25,50]},mutations:{updateSettings:function(e,t){var n=t.field,i=t.value;n||i||(n=o()(t)[0],i=t[n]),e[n]=i}},actions:{},getters:{}}},169:function(e,t,n){"use strict";var i=n(7),o=n.n(i);t.a={updateState:function(e,t){var n=t.field,i=t.value;if(n||i||(n=o()(t).filter(function(e){return"id"!=e})[0],i=t[n]),t.id)return void(e.nodes[t.id][n]=i);e[n]=i},updatePopouts:function(e,t){var n=t.field,i=t.value;n||i||(n=o()(t)[0],i=t[n]),e.popouts[n]=i},updatePopups:function(e,t){var n=t.field,i=t.value;n||i||(n=o()(t)[0],i=t[n]),e.popups[n]=i},removePopout:function(e,t){var n=t.type,i=t.index;e.popouts[n].splice(i,1)},removePopup:function(e,t){var n=t.index;e.popups.splice(n,1)},addPopup:function(e,t){var n=t.popup;e.popups.push(n)},pushFlash:function(e,t){e.flashes.push(t)},resetNewItem:function(e){e.newItem.body="",e.newItem.due_date="0000-00-00 00:00:00",e.newItem.done_date="0000-00-00 00:00:00",e.newItem.done=!1,e.newItem.planned_time="",e.newItem.preparedTags=[]},addNode:function(e,t){var n=t.item;e.nodes[n.id]=n},addChild:function(e,t){var n=t.newParentId,i=t.index,o=t.item;if(e.nodes[n].children||(e.nodes[n].children=[]),e.nodes[n].children_order||(e.nodes[n].children_order=[]),!i)return e.nodes[n].children.push(o),void e.nodes[n].children_order.push(o.id);e.nodes[n].children.splice(i,0,o),e.nodes[n].children_order.splice(i,0,o.id)},deleteTempItem:function(e,t){var n=t.item,i=e.nodes[n.parent_id];e.nodes[n.parent_id].children=i.children.filter(function(e){return!e.temp}),e.nodes[n.parent_id].children_order=i.children_order.filter(function(e){return!e.toString().includes("tempItem")}),o()(e.nodes).forEach(function(t){t.toString().includes("tempItem")&&delete e.nodes[t]})},deleteChild:function(e,t){var n=t.index,i=t.id;e.nodes[i].children.splice(n,1),e.nodes[i].children_order.splice(n,1)},closeFlash:function(e,t){var n=t.flash;e.flashes=e.flashes.filter(function(e){return e!=n})}}},170:function(e,t,n){"use strict";var i=n(74),o=n(163);window.apiBaseURL="http://api.lucaban.dev/";var r={id:"z",created_by:null,parent_id:null,depth:0,children:[],children_order:[],body:"ALL",memo:"",planned_time:0,used_time:0,completion_rate:"0.0000",due_date:"0000-00-00 00:00:00",done_date:"0000-00-00 00:00:00",done:0,completion_memo:"",show_children:1,deleted_at:null,created_at:"0000-00-00 00:00:00",updated_at:"0000-00-00 00:00:00",parents_bodies:"",tagged:[]},d={};d[r.id]=r,t.a={languageContents:i.a,keybindings:o.a,nodes:d,source:r,root:r,apiBaseURL:apiBaseURL,orphans:[],debug:!1,doneData:null,addingNewUnder:null,addingNewAsChild:!1,addingNewAsFirstChild:!1,editingItem:null,editingItemTags:null,editingDoneDateItem:null,loading:!1,patching:!1,popups:[],popouts:{delete:[],timer:[],edit:[],guide:!1},flashes:[],timerItems:[],beforeEditCache_body:null,beforeEditCache_planned_time:null,fetchedDone:!1,blockBlur:!1,manualMobile:!1,newTag:null,setLanguage:null}},171:function(e,t,n){"use strict";function i(e){return e.depth=Number(e.depth),null==e.show_children&&(e.show_children=1),e.children||(e.children=[]),e.due_date||(e.due_date="0000-00-00 00:00:00"),e.done_date||(e.done_date="0000-00-00 00:00:00"),e.done||(e.done=!1),e.used_time||(e.used_time=0),e.tagged||(e.tagged=[]),e.children_order?"string"==typeof e.children_order&&(e.children_order=e.children_order.split(",").map(Number)):e.children_order=[],e}function o(e,t){var n=JSON.parse(a()(e)),o=t.nodes[n.parent_id];n=i(n),0==n.depth?(t.root=n,console.log("root-node")):o?o.children.push(n):t.orphans.push(n),t.nodes[n.id]=n}function r(e){if(console.log("initializeState() with fetchedData ↓"),console.log(e),e){var t={};return t.source=e,t.orphans=[],t.nodes={},t.root={},e.forEach(function(e){return o(e,t)}),t}}n.d(t,"a",function(){return r});var d=n(43),a=n.n(d)},335:function(e,t){},336:function(e,t){},337:function(e,t){},345:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},staticRenderFns:[]}},350:function(e,t,n){function i(e){var t=o[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var o={"./Error404.vue":[353,5],"./Hello.vue":[354,4],"./Index.vue":[355,1],"./Listo.vue":[356,0],"./Login.vue":[357,2],"./QuasarSplash.vue":[358,3]};i.keys=function(){return Object.keys(o)},e.exports=i,i.id=350},74:function(e,t,n){"use strict";t.a={en:{global:{sec:"sec",min:"min",hour:"hour",m:"m",h:"h",s:"s",cancel:"Cancel",delete:"Delete",save:"Save",reload:"Reload"},user:{login:"Login",logout:"Logout",register:"Register",email:"Email Address",password:"Password",name:"Name"},menu:{all:"All",today:"Today",journal:"Journal","?":"?",usedTime:"Used time",timeLeft:"Time left",items:"Items",done:"Done",total:"Total"},card:{duration:"Duration:",addTag:"Add tag:",edit:"Edit",copy:"Copy",setToday:"Do today",addAndContinue:"Add and continue",addAndClose:"Add and close"},tags:{done:"Done",today:"Today"},popouts:{reset:"Reset",ok:"Ok",reallyDelete:"Really delete",andAllChildren:"And all children",overtime:"overtime",total:"Total"},popups:{journalNotes:"Journal notes",completed:"Completed",completedB:"",usedTime:"Used time",reset:"Reset",setNotDone:"Undo completion"},guide:{action:"Action",key:"Key",keybindings:[{key:"T",note:"Do <u>T</u>oday"},{key:"S",note:"<u>S</u>topwatch / Timer"},{key:"tab",note:"Indent item"},{key:"enter",note:"Add item"},{key:"cmd/ctrl + enter",note:"Edit item"},{key:"shift + T",note:"Edit tags"},{key:"alt + click on tag",note:"Hide tag"},{key:"cmd/ctrl + ↑↓",note:"Move item up/down"},{key:"ctrl + shift + D",note:"Duplicate item"}],hints:{addItemHint:"Add some items!"}},flashes:{moveTopLvlItem:"You cannot move this item when there is a filter.",cannotDoThisInJournal:"You cannot do this in the Journal.",ajaxError:"Error with connection. Reloading in "}},ja:{global:{sec:"秒",min:"分",hour:"時",m:"分",h:"時",s:"秒",cancel:"キャンセル",delete:"削除",save:"保存",reload:"再読込"},user:{login:"ログイン",logout:"ログアウト",register:"登録",email:"メールアドレス",password:"パスワード",name:"名前"},menu:{all:"全て",today:"今日",journal:"日報","?":"？",usedTime:"使用時間",timeLeft:"残時間",items:"アイテム",done:"完了",total:"合計"},card:{duration:"使用時間:",addTag:"タグを追加:",edit:"編集",copy:"コピー",setToday:"今日やる",addAndContinue:"複数追加",addAndClose:"追加して閉じる"},tags:{done:"完了",today:"今日"},popouts:{reset:"リセット",ok:"Ok",reallyDelete:"本当に削除しますか？",andAllChildren:"とその中の全てのアイテム",overtime:"オーバータイム",total:"合計"},popups:{journalNotes:"日報メモ",completed:"",completedB:"を完了致しました",usedTime:"使用時間",reset:"リセット",setNotDone:"完了取り消し"},guide:{action:"アクション",key:"ショートカットキー",keybindings:[{key:"T",note:"今日のタスクとして設定"},{key:"S",note:"ストップウォッチ / タイマー"},{key:"tab",note:"アイテムを右へ"},{key:"enter",note:"アイテムを追加"},{key:"cmd/ctrl + enter",note:"アイテムを編集"},{key:"shift + T",note:"タグを編集"},{key:"alt + click on tag",note:"タグのアイテムを非表示"},{key:"cmd/ctrl + ↑↓",note:"アイテムを上下へ移動"},{key:"ctrl + shift + D",note:"アイテムを複製"}],hints:{addItemHint:"アイテムを追加しよう！"}},flashes:{moveTopLvlItem:"フィルタをかけた際、このアイテムは動かせません。",cannotDoThisInJournal:"日報では機能しません。",ajaxError:"接続エラー。再読込まで "}}}}},[160]);