webpackJsonp([8],{10:function(e,t,n){"use strict";function i(e){return e.split(" ").map(function(e){return e.includes("+")||e.includes("click")?e:"<span class='o-keyboardkey'>"+e+"</span>"}).join(" ")}function o(e){if(!Array.isArray(e)||!e.length)return"";var t="";return e.forEach(function(e){t=t+","+e}),t.substring(1)}function r(e,t){return(" "+e.className+" ").includes(" "+t+" ")}function a(e,t){return(" "+e.className+" ").includes(" "+t+" ")||(e.className+=" "+t),e}function d(e,t){return e.className=" "+e.className+" ",e.className.includes(" "+t+" ")&&(e.className=e.className.replace(" "+t+" "," ")),e}function s(e){var t=[];return e=e.map(function(e){return e.trim()}),e.forEach(function(e){e.replace(/\s/g,"").length&&t.push(e)}.bind(t)),t}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";return e.sort(function(e,i){var o=e[t]?e[t].toUpperCase():" ",r=i[t]?i[t].toUpperCase():" ";return"asc"==n?o<r?-1:o>r?1:0:"desc"==n?o>r?-1:o<r?1:0:void 0}.bind(t))}function c(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"asc",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"asc",r={prop1:t,prop2:n};return e.sort(function(e,a){t=r.prop1,n=r.prop2;var d=void 0,s=void 0;if(d=e[t]?t.includes("date_forgetabboutit")?new Date(b()(new Date(e[t]),"YYYY/MM/DD")):e[t].toUpperCase():" ",s=a[t]?t.includes("date_forgetabboutit")?new Date(b()(new Date(a[t]),"YYYY/MM/DD")):a[t].toUpperCase():" ","asc"==i){if(d<s)return-1;if(d>s)return 1;if(!e[n]||!a[n])return 0;var l=e[n]?e[n].toUpperCase():" ",c=a[n]?a[n].toUpperCase():" ";if("asc"==o)return l>c?-1:l<c?1:0;if("desc"==o)return l<c?-1:l>c?1:0}else if("desc"==i){if(d>s)return-1;if(d<s)return 1;if(!e[n]||!a[n])return 0;var u=e[n]?e[n].toUpperCase():" ",m=a[n]?a[n].toUpperCase():" ";if("asc"==o)return u>m?-1:u<m?1:0;if("desc"==o)return u<m?-1:u>m?1:0}}.bind(r))}function u(e){return w()(new h.a(e))}function m(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}n.d(t,"e",function(){return i}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return r}),n.d(t,"j",function(){return m}),n.d(t,"f",function(){return l}),n.d(t,"k",function(){return c}),n.d(t,"i",function(){return s}),n.d(t,"d",function(){return _});var g=n(168),f=n.n(g),p=n(165),h=n.n(p),v=n(69),w=n.n(v),I=n(20),y=(n.n(I),n(2)),T=(n.n(y),n(331)),b=n.n(T),_={tagNameToSlug:function(e){if(e&&"string"==typeof e)return e.split(" ").join("-").toLowerCase()},tagSlugToName:function(e){return e=e.replace(/-/g," "),e=e.split(" ").map(function(e){var t=f()(e),n=t[0],i=t.slice(1);return n.toUpperCase()+i.join("").toLowerCase()}).join(" ")},AplusB:function(e,t){return parseFloat(e)+parseFloat(t)}}},115:function(e,t,n){"use strict";var i=n(351),o=n.n(i),r=n(131),a=n(129),d=n.n(a),s=n(133),l=n.n(s);t.a={install:function(e){window.eventHub=new e,e.prototype.$bus=window.eventHub,e.bus=window.eventHub,e.directive("flatpicky",{inserted:function(e){new o.a(e,r.a)}}),e.directive("focus",{inserted:function(e,t){t.modifiers.noMobile&&store.getters.mobile||(t.value||void 0===t.value)&&e.focus()}}),e.directive("autoheight",{inserted:function(t,n){e.nextTick(function(){d()(t)})}}),e.directive("autowidth",{inserted:function(t,n){e.nextTick(function(){l()(t)})}}),e.directive("btn-effect",{bind:function(e,t){e.addClass("btn").addClass("btn-dipclick"),e.addEventListener("click",function(t){e.addClass("btn--click"),setTimeout(function(){e.removeClass("btn--click")},400)})}}),e.directive("ios-dblclick",{inserted:function(e,t){}})}}},116:function(e,t,n){"use strict";var i=n(166),o=n.n(i),r=n(167),a=n.n(r),d=function(){function e(){o()(this,e),this.iniKeydownListenerPause(),this.iniKeyBindingListener()}return a()(e,[{key:"keystroke",value:function(e){if("journal"==store.state.selection.view&&("arrowRight"==e||"arrowLeft"==e||"meta_arrowUp"==e||"meta_arrowDown"==e||"meta_arrowRight"==e||"meta_arrowLeft"==e||"spaceBar"==e||"tab"==e||"shift_tab"==e||"t"==e||"-"==e||"s"==e)){console.log("cannot use "+e+" in journal mode");var t=store.getters.text.flashes.cannotDoThisInJournal;return console.log(t),void store.dispatch("sendFlash",{type:"warning",msg:t})}console.log(e),"meta_c"==e?store.dispatch("copyProgrammatic"):"arrowUp"==e?store.dispatch("selectItem",{direction:"prev"}):"arrowDown"==e?store.dispatch("selectItem",{direction:"next"}):"arrowRight"==e?store.dispatch("showChildren",{action:"show"}):"arrowLeft"==e?store.dispatch("showChildren",{action:"hide"}):"meta_arrowUp"==e?store.dispatch("moveItem",{direction:"up"}):"meta_arrowDown"==e?store.dispatch("moveItem",{direction:"down"}):"meta_arrowRight"==e?store.dispatch("indent"):"meta_arrowLeft"==e?store.dispatch("unindent"):"spaceBar"==e?store.dispatch("markDone"):"tab"==e?store.dispatch("indent"):"shift_tab"==e?store.dispatch("unindent"):"enter"==e?store.dispatch("showAddNewItem"):"shift_enter"==e?store.dispatch("showAddNewItem",{addAs:"child"}):"meta_enter"==e?store.dispatch("startEdit"):"ctrl_u"==e?store.dispatch("startEdit"):"t"==e?store.dispatch("setToday"):"-"==e?store.dispatch("setTomorrow"):"shift_t"==e?store.dispatch("startEditTags"):"s"==e?store.dispatch("addTimer"):"meta_shift_d"==e?store.dispatch("duplicate"):"meta_backspace"==e?store.dispatch("deleteItemDialogue"):"backspace"==e?store.dispatch("deleteItemDialogue"):"delete"==e&&store.dispatch("deleteItemDialogue")}},{key:"iniKeydownListenerPause",value:function(){window.keydownListenerPaused=!1,window.preventKeydownListener=function(){console.log("preventing keydown listener"),window.keydownListenerPaused=!0,setTimeout(function(){window.keydownListenerPaused=!1}.bind(this),100)}}},{key:"iniKeyBindingListener",value:function(){var e=this;window.addEventListener("keydown",function(t){if(!keydownListenerPaused){var n=t.keyCode;if("flatpickr-days"==document.activeElement.className&&9==n)return console.log("hiya!"),void t.preventDefault();if(store.state.popouts.delete.length||store.state.popouts.timer.length)27==n&&(t.preventDefault(),eventHub.$emit("clearAll"),console.log("Escape")),9==n&&(t.preventDefault(),t.shiftKey?store.dispatch("focusElement",{el:".btn-cancel"}):store.dispatch("focusElement",{el:".btn-ok"})),37==n&&(t.preventDefault(),store.dispatch("focusElement",{el:".btn-cancel"})),39==n&&(t.preventDefault(),store.dispatch("focusElement",{el:".btn-ok"}));else if(store.state.editingItem||store.state.addingNewUnder||store.state.editingItemTags){if("BUTTON"!=document.activeElement.nodeName)return;27==t.keyCode&&(store.state.editingItem?(store.dispatch("cancelEdit"),console.log("escapeOnEditButtonFocus")):store.state.addingNewUnder&&(store.dispatch("cancelAddNew"),console.log("escapeOnNewButtonFocus")))}else{if("INPUT"==document.activeElement.nodeName||"TEXTAREA"==document.activeElement.nodeName||"A"==document.activeElement.nodeName||"BUTTON"==document.activeElement.nodeName)return void console.log("inputs or buttons are focussed!");switch(t.keyCode){case 37:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowLeft");break}e.keystroke("arrowLeft");break;case 39:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowRight");break}e.keystroke("arrowRight");break;case 38:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowUp");break}e.keystroke("arrowUp");break;case 40:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_arrowDown");break}e.keystroke("arrowDown");break;case 32:t.preventDefault(),e.keystroke("spaceBar");break;case 9:if(t.preventDefault(),t.shiftKey){e.keystroke("shift_tab");break}e.keystroke("tab");break;case 13:t.preventDefault(),t.ctrlKey||t.metaKey?e.keystroke("meta_enter"):t.shiftKey?e.keystroke("shift_enter"):e.keystroke("enter");break;case 84:t.preventDefault(),t.ctrlKey||t.metaKey||t.shiftKey?e.keystroke("shift_t"):e.keystroke("t");break;case 83:e.keystroke("s");break;case 85:if(t.ctrlKey){e.keystroke("ctrl_u");break}e.keystroke("u");break;case 68:if(t.preventDefault(),(t.ctrlKey||t.metaKey)&&t.shiftKey){e.keystroke("meta_shift_d");break}break;case 8:if(t.preventDefault(),t.ctrlKey||t.metaKey){e.keystroke("meta_backspace");break}e.keystroke("backspace");break;case 46:t.preventDefault(),e.keystroke("delete");break;case 67:if((t.ctrlKey||t.metaKey)&&0==window.getSelection().toString()){t.preventDefault(),e.keystroke("meta_c");break}break;case 189:t.preventDefault(),e.keystroke("-")}}}})}}]),e}();t.a=d},117:function(e,t,n){"use strict";function i(e){return function(){return n(363)("./"+e+".vue")}}var o=n(40),r=n(359);o.a.use(r.a),t.a=new r.a({routes:[{path:"/",component:i("Index"),children:[{path:"",component:i("Listo")},{path:"login",component:i("Login")},{path:"register",component:i("Register")}]},{path:"*",component:i("Error404")}]})},118:function(e,t,n){"use strict";var i=n(68),o=n(155),r=n(162),a=n(153),d=n(160),s=n(161),l=n(157),c=n(159),u=n(158);t.a=function(){return{state:n.i(i.a)(),getters:o.a,mutations:r.a,actions:a.a,modules:{user:d.a,userSettings:s.a,api:l.a,selection:c.a,newItem:u.a}}}},119:function(e,t){},120:function(e,t){},124:function(e,t,n){function i(e){n(350)}var o=n(127)(n(151),n(358),i,null,null);e.exports=o.exports},128:function(e,t,n){"use strict";function i(e){return o(e)}function o(e){function t(e){return("0"+e).slice(-2)}var n=void 0,i=Math.floor(e/60);n=e%60;var o=Math.floor(i/60);return i%=60,o>0?t(o)+":"+t(i)+":"+t(n):t(i)+":"+t(n)}function r(e){function t(e,t){return e>0?e+" "+t:""}var n=void 0,i=Math.floor(e/60);n=e%60;var o=Math.floor(i/60);return i%=60,o>0?t(o,c.global.hour+" ")+t(i,c.global.min):i>0?t(i,c.global.min+" ")+t(n,c.global.sec):t(n,c.global.sec)}function a(e){function t(e,t){return e>0?e+" "+t:""}var n=Math.floor(e/60);var i=Math.floor(n/60);return n%=60,i>0?t(i,c.global.hour+" ")+t(n,c.global.min):t(n,c.global.min)}function d(e){e=new Date(e.replace(/-/g,"/"));var t=n.i(s.a)(e,new Date,{addSuffix:!0});return t.includes("at")&&(t=t.substring(0,t.indexOf(" at"))),t}n.d(t,"d",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return d});var s=n(19),l=n(67),c=window.store?store.getters.text:l.a.en},131:function(e,t,n){"use strict";t.a={dateFormat:"Y-m-d H:i:S",maxDate:"today",time_24hr:!0,onOpen:function(e,t,n){var i=n.element.name;store.state.beforeEditCache_doneDate||(store.state.beforeEditCache_doneDate={}),console.log("flatPickr[onOpen] id: "+i+".    dateStr: "+t),store.state.beforeEditCache_doneDate[i]=t},onClose:function(e,t,n){var i=n.element.name;console.log("flatPickr[onClose] id: "+i+".    dateStr: "+t),console.log("store.state.beforeEditCache_doneDate[id] = "+store.state.beforeEditCache_doneDate[i]),store.state.beforeEditCache_doneDate[i]!=t&&(store.dispatch("patch",{id:i,field:"done_date",value:t}),delete store.state.beforeEditCache_doneDate[i])}}},151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n.n(i),r=n(10),a=n(61),d=n.n(a),s=n(40),l=n(32),c=n(122),u=(n.n(c),n(121)),m=(n.n(u),n(126)),g=n(118),f=n(31),p=n(125),h=n.n(p),v=n(117),w=n(116),I=n(115),y=n(123),T=n.n(y);n(119),window.Element.prototype.hasClass=function(e){return n.i(r.a)(this,e)},window.Element.prototype.addClass=function(e){return n.i(r.b)(this,e)},window.Element.prototype.removeClass=function(e){return n.i(r.c)(this,e)},window.axios=d.a,window.Vue=s.a,s.a.config.productionTip=!1,s.a.use(l.a,{components:{QBtn:l.b,QIcon:l.c,QPopover:l.d,QModal:l.e,QSpinnerOval:l.f,QLayout:l.g,QFixedPosition:l.h,QProgress:l.i}}),s.a.use(m.a),window.store=new m.a.Store(n.i(g.a)()),window.itemGetters={},o()(store.state.nodes).forEach(function(e){itemGetters[e]=new s.a({store:store,data:{item:store.state.nodes[e]},computed:f.a})}),s.a.use(h.a),window.router=v.a,new w.a,s.a.use(I.a),s.a.use(T.a),window.vm=new s.a({el:"#q-app",router:v.a,store:store,render:function(e){return e(n(124))}}),n(120)},153:function(e,t,n){"use strict";var i=n(163),o=n.n(i),r=n(2),a=n.n(r),d=n(20),s=n.n(d),l=n(19),c=n(10),u=n(33),m=n(32),g=m.l.addToDate;t.a={resetStore:function(e){var t=e.commit;t("newItem/resetStateData"),t("selection/resetStateData"),t("userSettings/resetStateData"),t("user/resetStateData"),t("resetStateData")},giveNewParent:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.id,d=r.new_parent_id,s=r.specificNewIndex;if(itemGetters[a].isTopLvlItemInFilteredRoot){var l=o.text.flashes.moveTopLvlItem;return console.log(l),void i("sendFlash",{type:"warning",msg:l})}console.log("giving new parent");var c=t.nodes[a].parent_id,u=t.nodes[a],m=t.nodes[d];console.log("newParent ↓ "),console.log(m);var g=t.nodes[c];console.log("prevParent ↓ "),console.log(g);var f=itemGetters[a].siblingIndex;if(n("updateState",{id:a,field:"parent_id",value:d}),n("updateState",{id:a,field:"depth",value:m.depth+1}),m.children_order||n("updateState",{id:d,field:"children_order",value:[]}),s||0==s)n("addChild",{index:s,item:u,newParentId:d});else if(g.depth-1==m.depth&&d==g.parent_id){var p=itemGetters[g.id].siblingIndex+1;n("addChild",{index:p,item:u,newParentId:d})}else n("addChild",{item:u,newParentId:d});n("updateState",{field:"show_children",id:d,value:1}),n("deleteChild",{index:f,id:g.id}),0==g.children.length&&n("updateState",{field:"children",id:g.id,value:[]}),i("attachParentBody",{id:a}),i("tagItem",{id:a,tags:itemGetters[d].itemTagArray}),i("patch",{id:a,field:"depth"}),i("patch",{id:a,field:"parent_id"}),i("patch",{id:d,field:"children_order"}),i("patch",{id:d,field:"show_children"}),i("patch",{id:c,field:"children_order"}),i("updateChildrenDepth",{id:u.id}),i("updateChildrenDueDate",{id:d}),i("updateChildrenDueDate",{id:c}),i("autoCalculateDoneState",{id:d}),i("autoCalculateDoneState",{id:c})},duplicate:function(e){var t=e.state,n=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;o=o||t.selection.selectedId;var r=t.nodes[o],a=itemGetters[o].siblingIndex+1,d=JSON.parse(s()(r));n("postNewItem",{newItem:d,index:a,addNextItemAs:null,addTags:d.tagged.map(function(e){return e.tag_name}),duplication:!0})},addAndCleanNodesRecursively:function(e){var t=e.commit,i=e.dispatch,o=(e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),r=o.item,a=performance.now();r=n.i(u.a)(r);var d=performance.now();t("addNode",{item:r});var s=performance.now();console.log("\t\t\tcall to addAndCleanNodesRecursively part A took "+(s-d)+" milliseconds."),r.children.length&&r.children.forEach(function(e){return i("addAndCleanNodesRecursively",{item:e})});var l=performance.now();console.log("\t\t\tcall to addAndCleanNodesRecursively took "+(l-a)+" milliseconds.")},addFetchedNodes:function(e,t){var n=e.commit,i=t.nodes;a()(i).forEach(function(e){n("addNode",{item:i[e]})})},addItem:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.item,d=r.index,s=r.addNextItemAs,l=r.addTags,c=r.duplication,u=performance.now();console.log("addItem to DOM"),console.log(a),o["user/loggedIn"]&&!a.id.toString().includes("tempItem")&&(console.log("deleting temp item"),n("deleteTempItem",{item:a})),i("addAndCleanNodesRecursively",{item:a}).then(function(){n("addChild",{newParentId:a.parent_id,index:d,item:a}),l&&i("tagItem",{id:a.id,tags:l}),i("autoCalculateDoneState",{id:a.parent_id}),a.id.toString().includes("tempItem")||(console.log("patching parent order: "+a.parent_id),i("patch",{id:a.parent_id,field:"children_order"})),c||"stop"==s?t.addingNewUnder=null:i("showAddNewItem",{id:a.id,addAs:s}),Vue.nextTick(function(){return i("scrollToItemIfNeeded",{id:a.id})});var e=performance.now();console.log("\t\t\tcall to addItem took "+(e-u)+" milliseconds.")})},addTempNewItem:function(e){var t=e.dispatch,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.item,o=n.index,r=n.addNextItemAs,a=n.addTags;console.info("adding Temp item"),t("addItem",{item:i,index:o,addNextItemAs:r,addTags:a})},hideTaggedNodes:function(e){var t=e.state,n=e.getters,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.tag;a()(t.nodes).forEach(function(e){e=parseFloat(e),n.hasTag(e,o)&&(t.selection.hiddenItems.includes(e)||t.selection.hiddenItems.push(e))})},hideDoneNodes:function(e){var t=e.state;a()(t.nodes).forEach(function(e){e=parseFloat(e),t.nodes[e].done&&(t.selection.hiddenItems.includes(e)||t.selection.hiddenItems.push(e))})},sortAllChildren:function(e){var t=e.state,n=e.dispatch;t.root.children&&t.root.children.length&&(console.log("sorting all items"),a()(t.nodes).forEach(function(e){n("sortChildren",{id:e}),n("updateChildrenDueDate",{id:e})}))},sortChildren:function(e){var t=e.state,n=(e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id,o=t.nodes[i];o.children_order=o.children_order.filter(function(e){return o.children.includes(t.nodes[e])});var r=o.children_order,a=o.children;r instanceof Array&&r.length&&(o.children=r.map(function(e){return a.find(function(t){return t.id===e})}))},updateChildrenDepth:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id,r=t.nodes[o].children;if(!r&&!r.length)return!1;r.forEach(function(e){return console.log(e),e.depth=t.nodes[e.parent_id].depth+1,n("patch",{id:e.id,field:"depth"}),n("updateChildrenDepth",{id:e.id}),!0})},copyParentBodyToAllChildren:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.parent_id;if(o){var r=t.nodes[o];if(r.children_order.length){var a=r.body;r.children_order.forEach(function(e){var i=t.nodes[e];i.parents_bodies=a,vm&&n("patch",{id:i.id,field:"parents_bodies"})})}}},attachParentBody:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;if(r){var a=t.nodes[r];if(a.parent_id){var d=t.nodes[a.parent_id];d&&(n("updateState",{id:r,parents_bodies:d.body}),i("patch",{id:r,field:"parents_bodies"}))}}},deleteItem:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;r||console.log("item id not specified at deleteItem");var a=t.nodes[r],d=itemGetters[r].prevItemId?itemGetters[r].prevItemId:null;if(Array.isArray(a.children)&&a.children.length){var s=itemGetters[r].allVisibleChildIds;n("deleteItemApi",{idOrArray:s}),s.forEach(function(e){vm.$delete(t.nodes,e)})}var l=a.parent_id,c=t.nodes[l];if(c){var u=itemGetters[r].siblingIndex;c.children.splice(u,1),c.children_order.splice(u,1),n("patch",{id:l,field:"children_order"})}n("deleteItemApi",{idOrArray:r}),"journal"==t.selection.view&&(t.selection.view=null,t.selection.view="journal"),"tree"==t.selection.view&&(t.selection.view="journal",t.selection.view="tree"),i["selection/dueTodayFiltered"]&&(t.selection.filter.dueDate.to=null,t.selection.filter.dueDate.to=new Date);var m=itemGetters[d].nextItemId?itemGetters[d].nextItemId:null;console.log("new selected ID is: "+m),t.selection.selectedId=m,vm.$delete(t.nodes,r)},tagItem:function(e){var t=e.state,i=(e.commit,e.dispatch),o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.selection.selectedId,tags:t.newTag,requestType:"tag"},a=r.id,d=void 0===a?t.selection.selectedId:a,l=r.tags,u=void 0===l?t.newTag:l,m=r.requestType,g=void 0===m?"tag":m,f=performance.now();if(u&&(u=JSON.parse(s()(u)),t.newTag=null,Array.isArray(u)||(u=[u]),u=n.i(c.i)(u),"tag"==g&&(u=u.filter(function(e){return!o.hasTag(d,e)})),u.length)){var p=performance.now();i("tagItemTemporarely",{id:d,tags:u,requestType:g});var h=performance.now();console.log("\t\t\tA point in tagItem call took "+(h-p)+" milliseconds.");var v=performance.now();i("patchTag",{id:d,tags:u});var w=performance.now();console.log("\t\t\tB point in tagItem call took "+(w-v)+" milliseconds.");var I=t.nodes[d];if(I){I.children.length&&I.children_order.forEach(function(e){i("tagItem",{id:e,tags:u})});var y=performance.now();console.log("\t\t\tCall to tagItem took "+(y-f)+" milliseconds.")}}},tagItemTemporarely:function(e){var t=(e.state,e.commit),n=(e.dispatch,e.getters),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:null,tags:null,requestType:"tag"},o=i.id,r=i.tags,a=i.requestType,d=void 0===a?"tag":a,s=performance.now();if(r){Array.isArray(r)||(r=[r]),r=r.map(function(e){return n.makeTagObject(e)}),"untag"==d?t("deleteTag",{id:o,tags:r}):t("addTagTemporarely",{id:o,tags:r});var l=performance.now();console.log("\t\t\tCall to dispatch tagItemTemporarely took "+(l-s)+" milliseconds.")}},prepareDonePatch:function(e){var t=e.state,i=e.commit,o=e.dispatch,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.id,d=t.nodes[a];if(d){if(d.done){var s=n.i(l.c)(new Date,"YYYY-MM-DD HH:mm:ss");console.log(s),i("updateState",{id:a,done_date:s})}else i("updateState",{id:a,done_date:"0000-00-00 00:00:00"});o("patchDone",{id:a}),d.done&&(o("popup",{id:a,type:"afterDone"}),o("attachParentBody",{id:a}))}},autoCalculateDoneState:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;0!=t.nodes[o].depth&&(1!=itemGetters[o].allChildrenAreDone||itemGetters[o].isProject)&&n("markDone",{id:o,markAs:"notDone"})},moveItem:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id,a=o.direction;if(r=r||t.selection.selectedId,itemGetters[r].isTopLvlItemInFilteredRoot){var d=i.text.flashes.moveTopLvlItem;return console.log(d),void n("sendFlash",{type:"warning",msg:d})}clearTimeout(window.patchDelay);var s=t.nodes[r].parent_id,l=t.nodes[s],c=itemGetters[r].siblingIndex;if("up"==a)if(0==c){if(0==l.depth)return void console.log("ceiling!");var u=itemGetters[s].olderSiblingId,m=u==l.parent_id?0:null;n("giveNewParent",{id:r,new_parent_id:u,specificNewIndex:m})}else l.children_order.splice(c,1),l.children_order.splice(c-1,0,r),n("sortChildren",{id:s}),window.patchDelay=setTimeout(function(){n("patch",{id:s,field:"children_order"})},1e3);else if("down"==a)if(c+1==l.children_order.length){if(0==l.depth)return void console.log("floor!");var g=itemGetters[r].nextSiblingOrParentsSiblingId;console.log("new_parent_id: "+g),n("giveNewParent",{id:r,new_parent_id:g,specificNewIndex:0})}else l.children_order.splice(c,1),l.children_order.splice(c+1,0,r),n("sortChildren",{id:s}),window.patchDelay=setTimeout(function(){n("patch",{id:s,field:"children_order"})},1e3);Vue.nextTick(function(){return n("scrollToItemIfNeeded",{id:r})})},flushDoneItems:function(e){var t=e.state,n=(e.commit,e.dispatch),i=t.nodes,o=a()(i);o.reduce(function(e,t){i[t].done&&n("deleteItem",{id:t})})},updateChildrenDueDate:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id,r=t.nodes[o];if(!r.children.length)return!1;r.children.forEach(function(e){r.dueDateParent?(e.dueDateParent=r.dueDateParent,n("updateChildrenDueDate",{id:e.id})):r.due_date&&"0000-00-00 00:00:00"!=r.due_date?(e.dueDateParent=r.due_date,n("updateChildrenDueDate",{id:e.id})):(e.dueDateParent=!1,n("updateChildrenDueDate",{id:e.id}))})},formatDone:function(e){var t=(e.state,e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=t.doneArray,o=i.reduce(function(e,t){if(t.done){var i=n.i(l.c)(t.done_date,"YYYY/MM/DD");e.hasOwnProperty(i)||(e[i]=[]),e[i].push(t)}return e},{});return a()(o).map(function(e){var t={};return t.date=e,t.items=o[e],t})},blockBlur:function(e){var t=e.state;e.commit,e.dispatch;t.blockBlur=!0,setTimeout(function(){t.blockBlur=!1},500)},startEdit:function(e){var t=e.state,n=e.commit,i=(e.dispatch,e.getters),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.item,a=o.event;a&&(a.srcElement.hasClass("done")||a.srcElement.hasClass("custom-tag"))||(console.log("startEdit"),r=r||t.nodes[t.selection.selectedId],n("updateState",{beforeEditCache_body:r.body}),n("updateState",{beforeEditCache_planned_time:r.planned_time}),n("updateState",{editingItem:r.id}),i.mobile&&store.$refs["edit-item-modal-"+r.id].open())},scrollToItemIfNeeded:function(e){var t=(e.state,e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=t.id;if(i){var o=document.getElementById("item-body-"+i);n.i(c.j)(o)||o.scrollIntoView()}},doneEdit:function(e){var t=e.state,n=e.commit,i=e.dispatch,r=e.getters,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.editingItem},d=a.id,s=void 0===d?t.editingItem:d;console.log("Done edit!"),i("blockBlur"),preventKeydownListener(),r.mobile&&store.$refs["edit-item-modal-"+s].close();var l=t.nodes[s];if(n("updateState",{editingItem:null}),n("updatePopouts",{edit:[]}),t.editingItemTags)return void n("updateState",{editingItemTags:null});l.body||n("updateState",{id:s,body:t.beforeEditCache_body}),("number"!=typeof l.planned_time||o()(l.planned_time))&&n("updateState",{id:s,planned_time:0}),l.planned_time!=t.beforeEditCache_planned_time&&i("patch",{id:s,field:"planned_time"}),l.body!=t.beforeEditCache_body&&(i("patch",{id:s,field:"body"}),i("copyParentBodyToAllChildren",{parent_id:s})),n("updateState",{beforeEditCache_body:null}),n("updateState",{beforeEditCache_planned_time:null})},cancelEdit:function(e){var t=e.state,n=e.commit,i=(e.dispatch,e.getters),o=t.editingItem?t.editingItem:t.editingItemTags;o&&(i.mobile&&store.$refs["edit-item-modal-"+o].close(),t.editingItem&&Vue.nextTick(function(){console.log("cancel edit. Reverting to: "+t.beforeEditCache_body),n("updateState",{id:o,body:t.beforeEditCache_body}),n("updateState",{id:o,planned_time:t.beforeEditCache_planned_time})}),n("updateState",{editingItem:null}),n("updateState",{editingItemTags:null}),n("updatePopouts",{edit:[]}))},cancelEditOrAdd:function(e){var t=e.state,n=(e.commit,e.dispatch);n("blockBlur"),t.addingNewUnder?n("cancelAddNew"):(t.editingItem||t.editingItemTags)&&n("cancelEdit")},cancelAddNew:function(e){var t=e.state;e.commit,e.dispatch;e.getters.mobile&&store.$refs["add-item-modal"].close(),console.log("cancelAddNew"),t.selection.selectedId!=t.addingNewUnder&&null!=t.selection.selectedId||(t.selection.selectedId=t.selection.lastSelectedId),t.addingNewUnder=null,t.addingNewAsChild=!1},addNew:function(e){var t=e.state,i=e.commit,o=e.dispatch,r=e.getters,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{addNextItemAs:null},d=a.addNextItemAs;o("blockBlur"),r.mobile&&"stop"==d&&store.$refs["add-item-modal"].close(),console.log("addingNew");var c=JSON.parse(s()(t.newItem));i("newItem/resetStateData"),c.newItem=null;var u=t.addingNewUnder,m=r["newItem/preparedPlusComputedTags"];if(c.body){!u&&t.selection.selectedId?u=t.selection.selectedId:u||t.selection.selectedId||(u=t.root.id);var g=t.nodes[u];c.parent_id=g.parent_id?g.parent_id:t.root.id,c.depth=g.depth?g.depth:1;var f=itemGetters[g.id].siblingIndex,p=isNaN(f)?0:f+1;if(console.log("\n\t\tadding new item["+c.body+"]\n\t\twith parent id = "+c.parent_id+"\n\t\tdepth = "+c.depth+"\n\t\tindex = "+p),t.addingNewAsChild&&(c.depth=g.depth+1,c.parent_id=g.id,p=0),"journal"==t.selection.view){c.done=1;var h=g&&0!=g.depth?g.done_date:n.i(l.c)(new Date,"YYYY-MM-DD HH:mm:ss");c.done_date=h}r["selection/dueTodayFiltered"]&&itemGetters[g.id].isTopLvlItemInFilteredRoot&&!t.addingNewAsChild&&(c.due_date=n.i(l.c)(new Date,"YYYY-MM-DD HH:mm:ss"),m=m.filter(function(e){return"Today"!=e})),console.log("sending newItem:"),console.log(JSON.parse(s()(c))),console.log("sending tags:"),console.log(m),i("resetNewItem"),o("addTempNewItem",{item:c,index:p,addNextItemAs:d,addTags:m}).then(function(){return o("postNewItem",{newItem:c,index:p,addNextItemAs:d,addTags:m,duplication:null})})}},showChildren:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id,a=o.action;r=r||t.selection.selectedId;var d=t.nodes[r];if(d.children&&d.children.length){if("show"==a){if(d.show_children)return;n("updateState",{id:r,show_children:!0})}else if("hide"==a){if(!d.show_children)return;n("updateState",{id:r,show_children:!1})}else n("updateState",{id:r,show_children:!d.show_children});i("patch",{id:r,field:"show_children"})}},markDone:function(e){var t=e.state,n=e.commit,i=e.dispatch,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id,a=o.markAs;if(r=r||t.selection.selectedId){var d=t.nodes[r];if(d){if("notDone"==a){if(!d.done)return;return n("updateState",{id:r,done:!1}),void i("prepareDonePatch",{id:r})}if(!d.children.length||itemGetters[r].allChildrenAreDone){if("done"==a){if(d.done)return;n("updateState",{id:r,done:!0})}else n("updateState",{id:r,done:!d.done});i("prepareDonePatch",{id:r})}}}},indent:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;o=o||t.selection.selectedId;var r=itemGetters[o].olderSiblingId;if(r==t.nodes[o].parent_id)return void console.log("bump! ceiling!");console.log("new_parent_id / olderSiblingId: "+r),n("giveNewParent",{id:o,new_parent_id:r})},unindent:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;o=o||t.selection.selectedId;for(var r=t.nodes[o].depth,a=itemGetters[o].olderSiblingId,d=t.nodes[a].depth;d!=r-1;)a=itemGetters[a].olderSiblingId,d=t.nodes[a].depth;var s=a,l=d;return console.log("new_parent: "+s),s?0==l&&1==r?void console.log("crash! floor!"):(s==t.nodes[o].parent_id&&(s=t.nodes[s].parent_id),void n("giveNewParent",{id:o,new_parent_id:s})):void console.log("crash! floor!")},selectItem:function(e){var t=e.state,n=(e.commit,e.dispatch),i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.selection.selectedId},r=o.id,a=void 0===r?t.selection.selectedId:r,d=o.direction,s=void 0;if(d){if("next"==d)s=a&&a!=t.root.id?itemGetters[a].nextItemId:i.filteredIdsTree[0];else if("prev"==d)if(a&&a!=t.root.id)s=itemGetters[a].prevItemId;else{var l=i.filteredIdsTree;s=l[l.length-1]}}else s=a;t.selection.selectedId=s,n("scrollToItemIfNeeded",{id:s})},setToday:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;if(o=o||t.selection.selectedId){var r=t.nodes[o];if(r)return itemGetters[o].hasParentDueToday&&"0000-00-00 00:00:00"==r.due_date?void console.log("parent is already due"):void n("setDueDate",{id:o})}},setTomorrow:function(e){var t=e.state,i=(e.commit,e.dispatch),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.id;if(r=r||t.selection.selectedId){var a=g(new Date,{days:1});a=n.i(l.c)(a,"YYYY-MM-DD HH:mm:ss"),i("setDueDate",{id:r,duedate:a})}},setDueDate:function(e){var t=e.state,i=(e.commit,e.dispatch),o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{duedate:!1},a=r.id,d=r.duedate,s=d?new Date(d):new Date,c=new Date(t.nodes[a].due_date.replace(/-/g,"/")),u=n.i(l.b)(c,s);s=0==u?"0000-00-00 00:00:00":n.i(l.c)(s,"YYYY-MM-DD hh:mm:ss"),t.nodes[a].due_date=s,0==u&&o["selection/dueTodayFiltered"]&&(t.selection.selectedId=itemGetters[a].nextItemId),i("patchDueDate",{id:a,duedate:s}),i("updateChildrenDueDate",{id:a})},showAddNewItem:function(e){var t=e.state,n=(e.commit,e.dispatch,e.getters),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.selection.selectedId},o=i.id,r=void 0===o?t.selection.selectedId:o,a=i.addAs;n.mobile&&store.$refs["add-item-modal"].open(),r=r||t.root.id,console.log("showing add new item for id: "+r),r&&(t.addingNewUnder=r,t.selection.lastSelectedId=r,t.selection.selectedId=null,t.addingNewAsChild="child"==a,n.mobile&&Vue.nextTick(function(){document.querySelector(".js-edit-body").focus()}))},startEditTags:function(e){var t=e.state,n=(e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id;(i=i||t.selection.selectedId)&&(t.editingItemTags=i)},stopPatching:function(e){var t=e.state;e.commit,e.dispatch;window.stopPatchingIcon&&clearTimeout(window.stopPatchingIcon),window.stopPatchingIcon=setTimeout(function(){t.patching=!1}.bind(t),300)},startPatching:function(e){var t=e.state;e.commit,e.dispatch;window.stopPatchingIcon&&clearTimeout(window.stopPatchingIcon),t.patching=!0},deleteItemDialogue:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;o=o||t.selection.selectedId,n("popout",{id:o,type:"confirm-delete"})},popup:function(e){var t=e.state,n=(e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id,o=n.type;i=i||t.selection.selectedId;var r=t.nodes[i];t.popups.filter(function(e){return e.item.id===i})[0]||t.popups.push({item:r,type:o,timeout:!0,time:10})},sendFlash:function(e){var t=(e.state,e.commit);e.dispatch;t("pushFlash",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},popout:function(e){var t=e.state,n=(e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id,o=n.type;if(i=i||t.selection.selectedId){var r=t.nodes[i];"timer"==o&&(t.popouts.timer.push(r),Vue.nextTick(function(){console.log("emitting playTimer on Vue.nextTick"),Vue.bus.$emit("playTimer",r)})),"confirm-delete"==o&&t.popouts.delete.push(r)}},addTimer:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:t.selection.selectedId},o=i.id;n("popout",{id:void 0===o?t.selection.selectedId:o,type:"timer"})},copyProgrammatic:function(e){var t=e.dispatch,n=e.state,i=e.getters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:n.selection.selectedId},r=o.id,a=void 0===r?n.selection.selectedId:r,d=itemGetters[a].clipboardText,s=document.createElement("textarea");s.style.position="fixed",s.style.top=0,s.style.left=0,s.style.width="2em",s.style.height="2em",s.style.padding=0,s.style.border="none",s.style.outline="none",s.style.boxShadow="none",s.style.background="transparent",s.value=d,document.body.appendChild(s),s.select();try{document.execCommand("copy");t("sendFlash",{type:"success",msg:n.keybindings.copyClipboard.success[i.language]+"\n\n"+itemGetters[a].clipboardText})}catch(e){t("sendFlash",{type:"error",msg:""+n.keybindings.copyClipboard.error[i.language]})}document.body.removeChild(s)},prepareTag:function(e){var t=e.state;t.newTag&&t.newTag.trim()&&(t.newItem.preparedTags.push(t.newTag),t.newTag=null)},blurOnEditOrAdd:function(e){var t=e.dispatch,n=e.commit,i=e.state,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{field:null},a=r.field;if(i.addingNewUnder){var d=i.newItem.planned_time?parseFloat(i.newItem.planned_time):0;n("newItem/updateState",{planned_time:d})}if(!i.blockBlur){if(o.mobile&&"add-tag"==a){if(i.editingItem)return void t("tagItem",{id:i.editingItem,tags:i.newTag});if(i.addingNewUnder)return void t("prepareTag")}o.mobile||setTimeout(function(){"INPUT"!=document.activeElement.nodeName&&"TEXTAREA"!=document.activeElement.nodeName&&"A"!=document.activeElement.nodeName&&"BUTTON"!=document.activeElement.nodeName&&(i.editingItem&&(console.log("blurring on edit"),t("doneEdit")),i.editingItemTags&&(console.log("blurring on edit tags"),n("updateState",{editingItemTags:null})),i.addingNewUnder&&(console.log("bluring on Add New"),t("cancelAddNew")))},50)}},doneEditOrCancelNew:function(e){var t=e.state,n=e.dispatch;t.editingItem&&(console.log("blurring on edit"),n("doneEdit")),t.addingNewUnder&&(console.log("bluring on Add New"),n("cancelAddNew"))},doneEditOrAddNew:function(e){var t=e.state,n=e.dispatch,i=e.commit;t.editingItemTags?i("updateState",{editingItemTags:null}):t.editingItem?n("doneEdit"):t.addingNewUnder&&n("addNew")},focusElement:function(e,t){var n=(e.state,t.el);console.log("trying to focus: "+n),document.querySelector(n).focus()},filterItems:function(e){var t=e.state,n=(e.commit,e.dispatch),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.keyword,r=i.value,a=i.event;if(!t.editingItem){var d=null;a&&(a.preventDefault(),a.ctrlKey||a.metaKey?d="AND":a.altKey&&(d="NOT")),"journal"!=o||t.fetchedDone||n("fetchDone",{tags:null,operator:d}),n("selection/addKeywords",{keyword:o,value:r,operator:d})}},removeHiddenTag:function(e){var t=e.state,n=(e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.tag;t.selection.hiddenTags=t.selection.hiddenTags.filter(function(e){return e!==i})},test:function(e){var t=(e.state,e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});t.id;document.querySelectorAll(".tag-menu a").forEach(function(e){return alert(s()(e.style.color))})},alert:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=(e.state,e.commit,e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=t.value;alert(n)})}},154:function(e,t,n){"use strict";function i(e,t){var i=JSON.parse(a()(e)),o=t.nodes[i.parent_id];i=n.i(d.a)(i),0==i.depth?(t.root=i,console.log("root-node")):o?o.children.push(i):t.orphans.push(i),t.nodes[i.id]=i}function o(e){if(console.log("organizeData() with fetchedData ↓"),console.log(e),e){var t={};return t.source=e,t.orphans=[],t.nodes={},t.root={},e.forEach(function(e){return i(e,t)}),t}}t.a=o;var r=n(20),a=n.n(r),d=n(33)},155:function(e,t,n){"use strict";var i=n(2),o=n.n(i),r=n(19),a=n(32),d=n(10);n(128);t.a={filteredItemsUsedSec:function(e,t){return itemGetters[e.root.id].totalVisibleUsedSec},filteredItemsSecLeft:function(e,t){return itemGetters[e.root.id].totalVisibleSecLeft},hasTag:function(e,t){return function(t,n){console.log("running hasTag...");var i=e.nodes[t];if(!i)return console.log("[hasTag(id, tags)] what is state shit... id:"+t),!1;if(!i.tagged||!i.tagged.length)return!1;var o=void 0;return Array.isArray(n)||(n=[n]),n.forEach(function(e){e=d.d.tagNameToSlug(e),i.tagged.find(function(t){return t.tag_slug==e})&&(o=!0)}),o}},hasParentWithTag:function(e,t){return function(n,i){if(console.log("running hasParentWithTag..."),!n)return!1;var o=(e.nodes[n],e.nodes[n].parent_id);return!!o&&(!!e.nodes[o]&&(!!t.hasTag(o,i)||t.hasParentWithTag(o,i)))}},parentIdWithTag:function(e,t){return function(n,i){console.log("running parentIdWithTag...");var o=e.nodes[n];console.log("id & body = "+o.id+" - "+o.body);var r=e.nodes[n].parent_id;if(!r)return!1;var a=t.hasTag(r,i);return console.log("parentHasTag"),console.log(a),a?r:t.parentIdWithTag(r,i)}},checkValParentTree:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){return function(n,i){console.log("running checkValParentTree...");var o=e.nodes[n].parent_id;if(console.log("checkValParentTree pId: "+checkValParentTree),!o)return!1;var r=e.nodes[o].item[i];return console.log("checkValParentTree checkVal: "+r),r||t.checkValParentTree(o,i)}}),clipboardTextJournal:function(e,t){return function(e){console.log("running clipboardTextJournal...");var n=t.journalDate(e)+"\n==========";return e.children.reduce(function(e,t){var n=t.completion_memo?"\n　　"+t.completion_memo:"";return e+(e.includes("【"+t.parents_bodies+"】")?"":"\n【"+t.parents_bodies+"】")+"\n・"+t.body+n},n)}},journalDate:function(e,t){return function(t){return console.log("running journalDate..."),!(!t||"journal"!=e.selection.view||!t.journalDate)&&t.done_date}},filteredItemsTreeDeepestChildren:function(e,t){return console.log("running filteredItemsTreeDeepestChildren..."),t.filteredIdsTree.map(function(e){return{id:e,deepestChild:itemGetters[e]?itemGetters[e].findDeepestVisibleChild:e}})},oS:function(e,t){return console.log("running oS..."),a.j.is.platform},language:function(e,t){return console.log("running language..."),e.setLanguage?e.setLanguage:defaultLanguage||"en"},text:function(e,t){return console.log("running text..."),e.languageContents[t.language]},desktop:function(e,t){return console.log("running desktop..."),a.j.is.desktop},mobile:function(e,t){return console.log("running mobile..."),!!e.manualMobile||a.j.is.mobile},mobileSmall:function(e,t){if(console.log("running mobileSmall..."),window.innerWidth<385)return!0},makeTagObject:function(e,t){return function(e){return console.log("running makeTagObject..."),Array.isArray(e)?e.map(function(e){return t.makeTagObject(e)}):{temp:!0,tag_name:e,tag_slug:d.d.tagNameToSlug(e),tag:{temp:!0,name:e,slug:d.d.tagNameToSlug(e)}}}},noItems:function(e,t){return console.log("running noItems..."),!itemGetters[e.root.id].visibleDirectChildren.length},editingOrAddingId:function(e,t){return e.editingItemTags?e.editingItemTags:e.editingItem?e.editingItem:e.addingNewUnder?e.addingNewUnder:void 0},filteredItems:function(e,t){return console.log("running filteredItems..."),t.filteredItemsTree},filteredItemsJournal:function(e,t){if(console.log("running filteredItemsJournal..."),"journal"!=e.selection.view)return[];var i={};return t.filteredItemsFlat.forEach(function(t){if(t.done){var o=n.i(r.c)(t.done_date,"YYYY-MM-DD");if(i[o]||(i[o]={date:o,items:[]}),!e.userSettings.journalShowParentBodies)return void i[o].items.push(t);var a=t.parents_bodies?t.parents_bodies:"null_no_parent_body",d=i[o].items.find(function(e){return e.parentBody==a});d?d.items.push(t):i[o].items.push({parentBody:a,items:[t]})}}),o()(i).map(function(e){return i[e]})},journalDates:function(e,t){return console.log("running journalDates..."),o()(t.filteredItemsJournal)},filteredIdsFlat:function(e,t){console.log("running filteredIdsFlat...");var n=performance.now();if(e.loading)return[];var i=[];console.log("running filteredIdsFlat");var r=o()(e.nodes).map(function(e){return Number(e)?Number(e):e});i=t["selection/noFilterOrTag"]?r.filter(function(t){return t!=e.root.id}):r.filter(function(n){return n!=e.root.id&&t["selection/testAgainstAllSelection"](n,{flat:!0})});var a=performance.now();return console.log("\t\t\tcall to filteredItemsFlat took "+(a-n)+" milliseconds."),i},filteredItemsFlat:function(e,t){console.log("running filteredItemsFlat...");var i=t.filteredIdsFlat.map(function(t){return e.nodes[t]}).filter(function(e){return void 0!==e});return"journal"==e.selection.view&&(i=n.i(d.k)(i,"done_date","parents_bodies","desc","asc")),i},filteredIdsTree:function(e,t){return console.log("running filteredIdsTree..."),t.filteredItemsTree.map(function(e){return e.id})},filteredItemsTree:function(e,t){console.log("running filteredItemsTree...");var i=performance.now();if(e.loading)return[];var r=[];r=t["selection/noFilterOrTag"]?e.root.children_order:o()(e.nodes).map(function(e){return Number(e)?Number(e):e}).filter(function(n){return n!=e.root.id&&t["selection/testAgainstAllSelection"](n,{flat:!1})}),console.log("Filtered Items Tree, IDs:"),console.log(r);var a=r.map(function(t){return e.nodes[t]});t["selection/dueTodayFiltered"]?a=n.i(d.k)(a,"done_date","due_date","asc","desc"):"journal"==e.selection.view&&(a=n.i(d.k)(a,"done_date","parents_bodies","desc","asc"));var s=performance.now();return console.log("\t\t\tcall to filteredItemsTree took "+(s-i)+" milliseconds."),a},allTagsComputed:function(e,t){console.log("running allTagsComputed...");var i=performance.now(),r=t.filteredItemsFlat;if(!r.length)return[];var a={},s=function(e){e.tag&&e.tag.name&&(a[e.tag_slug]=e.tag)};r.forEach(function(e){return e.tagged.forEach(s)});var l=o()(a).map(function(e){return a[e]});l=n.i(d.f)(l,"name");var c=performance.now();return console.log("\t\t\tcall to allTagsComputed 1c took "+(c-i)+" milliseconds."),l},itemAmount:function(e,t){return console.log("running itemAmount..."),t.filteredIdsFlat.length},doneItemAmount:function(e,t){return console.log("running doneItemAmount..."),t.filteredItemsFlat.filter(function(e){return e.done}).length},lastItems:function(e,t){if(console.log("running lastItems..."),t.noItems)return[];var n=t.filteredIdsTree[t.filteredIdsTree.length-1];return[n,itemGetters[n].findDeepestVisibleChild]},firstItem:function(e,t){return console.log("running firstItem..."),t.noItems?null:t.filteredIdsTree[0]}}},156:function(e,t,n){"use strict";t.a={copyClipboard:{mac:"",win:"",name:{en:"copy",ja:"コピー"},guide:{en:"Copy to clipboard",ja:"クリップボードにコピー"},popmenu:{en:"Copy to clipboard",ja:"クリップボードにコピー"},success:{en:"Copied successfully! Now go paste!",ja:"コピーしました！どこかにペーストしましょう！"},error:{en:"There was an error copy'ing! Please let <a href='mailto:mesqueeb@gmail.com'>Luca Ban</a> know!",ja:"コピーしようとしたけど、エラーが起きました！<a href='mailto:mesqueeb@gmail.com'>バン・ルカへのお知らせ</a>ください！"}},delete:{mac:"⌫",win:"⌫",name:{en:"delete",ja:"削除"},guide:{en:"Delete item",ja:"削除"},popmenu:{en:"Delete item",ja:"削除"}},setToday:{mac:"T",win:"T",name:{en:"do today",ja:"今日やる"},guide:{en:"Do <u>T</u>oday",ja:"今日に設定"},popmenu:{en:"Do <u>T</u>oday",ja:"今日に設定"}},setTomorrow:{mac:"-",win:"-",name:{en:"do tomorrow",ja:"明日やる"},guide:{en:"Do tomorrow",ja:"明日に設定"},popmenu:{en:"Do tomorrow",ja:"明日に設定"}},timer:{mac:"S",win:"S",name:{en:"timer",ja:"タイマー"},guide:{en:"<u>S</u>topwatch / Timer",ja:"ストップウォッチ / タイマー"},popmenu:{en:"",ja:""}},indent:{mac:"tab",win:"tab",name:{en:"",ja:""},guide:{en:"Indent item",ja:"アイテムを右へ"},popmenu:{en:"",ja:""}},add:{mac:"enter",win:"enter",name:{en:"",ja:""},guide:{en:"Add item",ja:"アイテムを追加"},popmenu:{en:"",ja:""}},edit:{mac:"⌘ enter",win:"ctrl enter",name:{en:"edit",ja:"編集"},guide:{en:"Edit item",ja:"アイテムを編集"},popmenu:{en:"Edit item",ja:"アイテムを編集"}},editTag:{mac:"shift T",win:"shift T",name:{en:"",ja:""},guide:{en:"Edit tags",ja:"タグを編集"},popmenu:{en:"",ja:""}},hideTag:{mac:"alt click",win:"alt click",name:{en:"",ja:""},guide:{en:"Hide tag",ja:"タグのアイテムを非表示"},popmenu:{en:"",ja:""}},move:{mac:"⌘ ↑↓",win:"ctrl ↑↓",name:{en:"",ja:""},guide:{en:"Move item up/down",ja:"アイテムを上下へ移動"},popmenu:{en:"",ja:""}},duplicate:{mac:"⌘ shift D",win:"ctrl shift D",name:{en:"",ja:""},guide:{en:"Duplicate item",ja:"アイテムを複製"},popmenu:{en:"Duplicate item",ja:"アイテムを複製"}}}},157:function(e,t,n){"use strict";var i=n(15),o=n.n(i),r=n(2),a=n.n(r),d=n(20),s=n.n(d),l=n(10),c=n(154),u=n(61),m=n.n(u),g=n(31),f=n(40);t.a={state:{token:null},mutations:{destroyToken:function(e){window.axios.defaults.headers.common={"X-Requested-With":"XMLHttpRequest",Authorization:"Bearer "},e.token=null},setToken:function(e,t){var n=t.token;window.axios.defaults.headers.common={"X-Requested-With":"XMLHttpRequest",Authorization:"Bearer "+n},e.token=n}},actions:{logout:function(e){var t=e.commit,n=e.dispatch,i=(e.getters,e.rootState,e.state);if(t("updateState",{loading:!0}),i.token){var o=JSON.parse(s()(i.token));m.a.post(apiBaseURL+"logout",{token:o}).then(function(e){var t=e.data;console.log(t)}),t("destroyToken")}n("resetStore").then(function(){t("updateState",{loading:!1})})},login:function(e,t){var n=e.commit,i=e.dispatch;e.getters,e.rootState;i("resetStore"),n("updateState",{loading:!0}),m.a.post(apiBaseURL+"auth",t).then(function(e){var t=e.data;n("setToken",{token:t.token}),i("fetchListo"),router.push("/")}).catch(function(e){var t=e.response,o=t.data;n("updateState",{loading:!1}),console.log(o);var r=a()(o).map(function(e){return o[e]}).map(function(e,t){return e[t]}).join("<br>");i("sendFlash",{msg:r})})},register:function(e,t){var n=e.commit,i=e.dispatch;e.getters,e.rootState;n("updateState",{loading:!0}),m.a.post(apiBaseURL+"register",t).then(function(e){var t=e.data;n("setToken",{token:t.token}),i("fetchListo"),router.push("/")}).catch(function(e){var t=e.response,o=t.data;n("updateState",{loading:!1}),console.log(o);var r=a()(o).map(function(e){return o[e]}).map(function(e,t){return e[t]}).join("<br>");i("sendFlash",{msg:r})})},fetchListo:function(e){var t=e.commit,n=e.dispatch;t("updateState",{loading:!0}),console.log("start fetching all items"),console.log(m.a.defaults.headers.common),m.a.get(apiBaseURL+"items").then(function(e){var i=e.data;console.log("fetched all items"),n("initializeState",{data:i}).then(function(){t("updateState",{loading:!1}),n("getUser")}).catch(function(e){console.log("ERROR: "+e)})}).catch(function(e){console.log("ERROR: "+e)})},initializeState:function(e,t){var i=e.dispatch,o=e.commit,r=t.data,d=n.i(c.a)(r);a()(d.nodes).forEach(function(e){itemGetters[e]=new f.a({store:store,data:{item:d.nodes[e]},computed:g.a})}),o("updateState",{source:d.source}),o("updateState",{orphans:d.orphans}),o("updateState",{root:d.root}),o("updateState",{nodes:d.nodes}),i("sortAllChildren")},getUser:function(e){var t=e.dispatch,n=e.commit;m.a.get(apiBaseURL+"user").then(function(e){var i=e.data;console.log(i),n("user/updateState",{user:i.user}),t("sendFlash",{msg:"Hello "+i.user.name+"!"})}).catch(function(e){console.log("ERROR: "+e.response)})},patch:function(e){var t=e.commit,i=e.dispatch,o=e.getters,r=e.rootState,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=a.id,s=a.field,c=a.value;if(!r.user.user)return void console.log("not Logged in");if(!d.toString().includes("tempItem")){i("startPatching");var u={},g=c||r.nodes[d][s];"children_order"==s&&(g=n.i(l.h)(g)),u[s]=g,m.a.patch(apiBaseURL+"items/"+d,u,{method:"PATCH"}).then(function(e){console.log("patched "+d+"["+r.nodes[d].body+"]."+s+" = "+u[s]),i("stopPatching")},function(e){t("updateState",{patching:"error"});var n=o.text.flashes.ajaxError;console.log(n),i("sendFlash",{type:"ajaxError",msg:n})})}},patchTag:function(e){var t=e.rootState,n=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id,r=i.tags,a=i.requestType;if(!t.user.user)return void console.log("not Logged in");if(!o.toString().includes("tempItem")){n("startPatching");var d={};d.tags=r,d.type=a,m.a.patch(apiBaseURL+"itemtags/"+o,d,{method:"PATCH"}).then(function(e){e.data.tags;console.log("tagged ["+t.nodes[o].body+"] with: "+e.data.tags+";"),console.log(e),m.a.get(apiBaseURL+"itemtags/"+o,{type:"tags"}).then(function(e){t.nodes[o].tagged=e.data,console.log("updatedTagList of ["+t.nodes[o].body+"] with: "+e.data.map(function(e){return e.tag_name})+";")}),n("stopPatching")})}},patchDueDate:function(e){var t=e.dispatch,n=e.rootState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id,r=i.duedate;if(!n.user.user)return void console.log("not Logged in");if(!o.toString().includes("tempItem")){if(t("startPatching"),"0000-00-00 00:00:00"==r)return void m.a.patch(apiBaseURL+"items/"+o,{due_date:r}).then(function(e){t("stopPatching")});r=new Date(r.replace(/-/g,"/")),console.log("PatchDueDate: "+r),m.a.patch(apiBaseURL+"items/"+o,{due_date:r}).then(function(e){t("stopPatching")})}},patchDone:function(e){var t=e.rootState,n=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id;if(!t.user.user)return void console.log("not Logged in");if(!o.toString().includes("tempItem")){n("startPatching");var r=void 0,a=t.nodes[o].done;r=a?new Date:"0000-00-00 00:00:00",m.a.patch(apiBaseURL+"items/"+o,{done:a,done_date:r}).then(function(e){n("stopPatching")})}},deleteItemApi:function(e){var t=e.rootState,n=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.idOrArray;if(!t.user.user)return void console.log("not Logged in");if(n("startPatching"),Array.isArray(o)&&o.length){o.forEach(function(e){n("deleteItemApi",{idOrArray:e})})}else{var r=o;if(r.toString().includes("tempItem"))return;if(!r)return;var a=t.nodes[r];m.a.delete(apiBaseURL+"items/"+r).then(function(e){console.log("deleted: "+r+"["+a.body+"]"),n("stopPatching")})}},fetchDone:function(e){var t=e.rootState,i=(e.dispatch,e.getters,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});i.tags,i.operator;if(!t.user.user)return void console.log("not Logged in");t.loading=!0,m.a.get(apiBaseURL+"items/fetchdone").then(function(e){var i=e.data;if(t.fetchedDone=!0,console.log("fetched Done"),!i.length)return console.log("no done items..."),void(t.loading=!1);var r=n.i(c.a)(i);a()(r.nodes).forEach(function(e){itemGetters[e]=new f.a({store:store,data:{item:r.nodes[e]},computed:g.a})}),o()(t.nodes,r.nodes),t.loading=!1})},postNewItem:function(e){var t=e.rootState,i=e.dispatch,o=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.newItem,d=r.index,s=r.addNextItemAs,c=r.addTags,u=r.duplication;if(console.log("posting newItem..."),console.log(a),!t.user.user)return void console.log("not Logged in");i("startPatching"),a.children_order&&(a.children_order=n.i(l.h)(a.children_order));var g=a;m.a.post(apiBaseURL+"items",g).then(function(e){var t=e.data;console.log("starting dom update..."),console.log("Index: "),console.log(d),i("addItem",{item:t,index:d,addNextItemAs:s,addTags:c,duplication:u}),i("stopPatching")},function(e){t.patching="error";var n=o.text.flashes.ajaxError;console.log(n),i("sendFlash",{type:"ajaxError",msg:n})})},patchRootChildrenOrderWithFilter:function(e){var t=e.rootState,n=(e.dispatch,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=n.id;if(!t.user.user)return void console.log("not Logged in");i.toString().includes("tempItem")||m.a.get(apiBaseURL+"items/"+t.root.id).then(function(e){var n=e.data.children_order;n=n+","+i,m.a.patch(apiBaseURL+"items/"+t.root.id,{children_order:n}).then(function(e){var t=e.data.children_order;console.log("newRootChildrenOrder = "+t)})})}},getters:{someGetter:function(e,t,n,i){return function(e){t.someOtherGetter,i.someOtherGetter}}}}},158:function(e,t,n){"use strict";var i=n(2),o=n.n(i),r=n(15),a=n.n(r),d=n(10),s=n(33),l=function(){return"tempItem_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},c=function(){return n.i(s.a)({body:"",preparedTags:[],newItem:!0,temp:!0,id:l()})};t.a={namespaced:!0,state:c(),mutations:{resetStateData:function(e){var t=c();e=a()(e,t)},updateState:function(e,t){var n=t.field,i=t.value;if(n||i||(n=o()(t).filter(function(e){return"id"!=e})[0],i=t[n]),t.id)return void(e.nodes[t.id][n]=i);e[n]=i},deleteTag:function(e,t){var n=t.tag;e.preparedTags=e.preparedTags.filter(function(e){return e!=n})}},actions:{someAction:function(e){var t=(e.state,e.rootState,e.getters),n=e.rootGetters,i=e.dispatch,o=e.commit,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.id;t.someOtherGetter,n.someOtherGetter,i("someOtherAction"),i("someOtherAction",null,{root:!0}),o("someMutation"),o("someMutation",null,{root:!0})}},getters:{someGetter:function(e,t,n,i){return function(e){t.someOtherGetter,i.someOtherGetter}},parent_id:function(e,t,n,i){return n.addingNewUnder&&n.addingNewUnder!=n.root.id?n.addingNewAsChild||n.addingNewAsFirstChild?n.addingNewUnder:n.nodes[n.addingNewUnder]?n.nodes[n.addingNewUnder].parent_id:null:n.root.id},preparedPlusComputedTags:function(e,t,i,o){var r=e.preparedTags,a=[];return itemGetters[t.parent_id]&&(a=itemGetters[t.parent_id].tagsArray),r=r.concat(a),r=r.concat(i.selection.tags.map(function(e){return d.d.tagSlugToName(e)})),r=n.i(d.g)(r),r.sort()}}}},159:function(e,t,n){"use strict";function i(){return{selectedId:null,lastSelectedId:null,filter:{dueDate:{from:null,to:null},doneDate:{from:null,to:null}},tags:[],hiddenTags:[],hiddenItems:[],hiddenBookmarks:[],view:"tree"}}var o=n(2),r=n.n(o),a=n(15),d=n.n(a),s=n(19);t.a={namespaced:!0,state:i(),mutations:{resetStateData:function(e){var t=i();e=d()(e,t)},clear:function(e){e.filter={dueDate:{from:null,to:null},doneDate:{from:null,to:null}},e.tags=[],e.hiddenTags=[],e.hiddenItems=[],e.hiddenBookmarks=[]},clearTags:function(e){e.hiddenTags=[],e.tags=[]},clearFilters:function(e){e.filter={dueDate:{from:null,to:null},doneDate:{from:null,to:null}},e.hiddenBookmarks=[]},updateState:function(e,t){var n=t.field,i=t.value;if(n||i||(n=r()(t).filter(function(e){return"id"!=e})[0],i=t[n]),t.id)return void(e.nodes[t.id][n]=i);e[n]=i}},actions:{addKeywords:function(e,t){var n=e.state,i=(e.rootState,e.getters,e.rootGetters),o=(e.dispatch,e.commit),r=t.keyword,a=t.value,d=t.operator;if("tag"==r)if("NOT"==d){if(n.hiddenTags.includes(a))return;n.hiddenTags.push(a),n.tags=n.tags.filter(function(e){return e!==a})}else n.tags.includes(a)?n.tags=n.tags.filter(function(e){return e!==a}):n.hiddenTags.includes(a)?n.hiddenTags=n.hiddenTags.filter(function(e){return e!==a}):(d||o("clearTags"),n.tags.push(a));else{if(d&&"all"!=r||o("clearFilters"),"all"==r&&(n.view="tree"),"NOT"==d&&"journal"==r)return void n.hiddenBookmarks.push(r);"journal"==r?(n.view="journal",n.filter.doneDate.to=a):n.view="tree","duedate"==r&&(n.filter.dueDate.to=a)}Vue.nextTick(function(){i.filteredItemsFlat.map(function(e){return e.id}).includes(n.selectedId)||(n.selectedId=null)})}},getters:{nothingSelected:function(e,t){return t.noTagsSelected&&t.noFiltersSelected&&!e.hiddenItems.length&&!e.hiddenBookmarks.length},noFilterOrTag:function(e,t){return t.noTagsSelected&&t.noFiltersSelected},noTagsSelected:function(e){return!e.tags.length&&!e.hiddenTags.length},noFiltersSelected:function(e,t){return!t.dueDateFiltered&&!t.doneFiltered},dueDateFiltered:function(e){return null!=e.filter.dueDate.from||null!=e.filter.dueDate.to},doneFiltered:function(e){return null!=e.filter.doneDate.from||null!=e.filter.doneDate.to},dueTodayFiltered:function(e){return 0==n.i(s.b)(e.filter.dueDate.to,new Date)},getHiddenItemsTotalUsedTime:function(e,t){return e.hiddenItems.length?e.hiddenItems.reduce(function(t,n){var i=e.nodes[n];return i?t+i.used_time:t},0):0},getHiddenItemsTotalPlannedTime:function(e,t){return e.hiddenItems.length?e.hiddenItems.reduce(function(t,n){var i=e.nodes[n];return i?t+i.planned_time:t},0):0},testAgainstTagSelection:function(e,t,n,i){return function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{flat:!1},r=o.flat,a=void 0!==r&&r;if(!e.tags.length&&!e.hiddenTags.length)return!0;var d=!1;if(e.hiddenTags.length&&(d=e.hiddenTags.some(function(e){return i.hasTag(t,e)})),e.hiddenTags.length&&e.tags.length)return!d&&n.root.children_order.includes(t);var s=!0,l=!1;return e.tags.length&&(s=e.tags.every(function(e){return i.hasTag(t,e)}),l=e.tags.every(function(e){return i.hasParentWithTag(t,e)})),a?s&&!d:s&&!d&&!l}},testAgainstDueDateSelection:function(e,t,n,i){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{flat:!1},i=n.flat,o=void 0!==i&&i,r=!0;if(t.dueTodayFiltered){var a=itemGetters[e].isDueToday,d=itemGetters[e].hasParentDueToday;r=o?!(!a&&!d):!(!a||d)}return r}},testAgainstDoneSelection:function(e,t,i,o){return function(e){var o=!0,r=i.nodes[e];if(!r)return!1;if(t.doneFiltered)o=!!r.done;else{var a=r.done_date?r.done_date.replace(/-/g,"/"):"0000-00-00 00:00:00",d=n.i(s.b)(new Date(a),new Date);o=!r.done||d>=0}return o}},testAgainstHiddenItems:function(e,t,n,i){return function(t){return e.hiddenItems.every(function(e){return e!=t})}},testAgainstAllSelection:function(e,t,n,i){return function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{flat:!1},r=o.flat,a=void 0!==r&&r,d=!0;if(a)d=t.testAgainstTagSelection(n,{flat:!0})&&t.testAgainstDueDateSelection(n,{flat:!0})&&t.testAgainstDoneSelection(n)&&t.testAgainstHiddenItems(n);else{var s=t.testAgainstDoneSelection(n),l=t.testAgainstHiddenItems(n);if(e.tags.length&&t.dueTodayFiltered){var c=itemGetters[n].hasParentDueToday,u=void 0;if(e.tags.length&&(u=e.tags.every(function(e){return i.hasParentWithTag(n,e)})),c&&u)return!1;d=t.testAgainstTagSelection(n,{flat:!0})&&t.testAgainstDueDateSelection(n,{flat:!0})&&s&&l}else d=t.testAgainstTagSelection(n)&&t.testAgainstDueDateSelection(n)&&s&&l}return d}}}}},160:function(e,t,n){"use strict";function i(){return{user:null}}var o=n(2),r=n.n(o),a=n(15),d=n.n(a);t.a={namespaced:!0,state:i(),mutations:{resetStateData:function(e){var t=i();e=d()(e,t)},updateState:function(e,t){var n=t.field,i=t.value;n||i||(n=r()(t)[0],i=t[n]),e[n]=i}},actions:{},getters:{loggedIn:function(e){return!!e.user}}}},161:function(e,t,n){"use strict";function i(){return{plannedDurations:[10,15,25,50],language:"en",journalShowParentBodies:!0}}var o=n(2),r=n.n(o),a=n(15),d=n.n(a);t.a={namespaced:!0,state:i(),mutations:{resetStateData:function(e){var t=i();e=d()(e,t)},updateState:function(e,t){var n=t.field,i=t.value;n||i||(n=r()(t)[0],i=t[n]),e[n]=i}},actions:{},getters:{}}},162:function(e,t,n){"use strict";var i=n(2),o=n.n(i),r=n(15),a=n.n(r),d=n(68),s=n(31);t.a={resetStateData:function(e){var t=n.i(d.a)();e=a()(e,t)},updateState:function(e,t){var n=t.field,i=t.value;if(n||i||(n=o()(t).filter(function(e){return"id"!=e})[0],i=t[n]),t.id)return void(e.nodes[t.id][n]=i);e[n]=i},updatePopouts:function(e,t){var n=t.field,i=t.value;n||i||(n=o()(t)[0],i=t[n]),e.popouts[n]=i},updatePopups:function(e,t){var n=t.field,i=t.value;n||i||(n=o()(t)[0],i=t[n]),e.popups[n]=i},removePopout:function(e,t){var n=t.type,i=t.index;e.popouts[n].splice(i,1)},removePopup:function(e,t){var n=t.index;e.popups.splice(n,1)},addPopup:function(e,t){var n=t.popup;e.popups.push(n)},pushFlash:function(e,t){e.flashes.push(t)},resetNewItem:function(e){e.newItem.body="",e.newItem.due_date="0000-00-00 00:00:00",e.newItem.done_date="0000-00-00 00:00:00",e.newItem.done=!1,e.newItem.planned_time="",e.newItem.preparedTags=[]},addNode:function(e,t){var n=t.item,i=performance.now();vm.$set(e.nodes,n.id,n),itemGetters[n.id]=new Vue({store:store,data:{item:store.state.nodes[n.id]},computed:s.a});var o=performance.now();console.log("\t\t\tCall to addNode took "+(o-i)+" milliseconds.")},addChild:function(e,t){var n=t.newParentId,i=t.index,o=t.item;if(e.nodes[n].children||(e.nodes[n].children=[]),e.nodes[n].children_order||(e.nodes[n].children_order=[]),!i)return e.nodes[n].children.push(o),void e.nodes[n].children_order.push(o.id);e.nodes[n].children.splice(i,0,o),e.nodes[n].children_order.splice(i,0,o.id)},addOrDeleteTempTag:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.id,i=t.tagObject,o=t.requestType,r=void 0===o?"tag":o;console.log(r+"ging items tempor "+n+' with "'+i.tag_name+'"'),"tag"==r&&(console.log(e.nodes[n].tagged),e.nodes[n].tagged.push(i),console.log(e.nodes[n].tagged)),"untag"==r&&(e.nodes[n].tagged=e.nodes[n].tagged.filter(function(e){return e.tag_slug!=i.tag_slug}))},deleteTag:function(e,t){var n=t.id,i=t.tags;if(!e.nodes[n])return void console.log("trying to tag an unexisting item");i.forEach(function(t){return e.nodes[n].tagged=e.nodes[n].tagged.filter(function(e){return e.tag_slug!=t.tag_slug})})},addTagTemporarely:function(e,t){var n=t.id,i=t.tags,o=performance.now();if(Array.isArray(i)||(i=[i]),!e.nodes[n])return void console.log("trying to tag an unexisting item");console.log("tagging items tempor "+n+' with... "'+i.map(function(e){return e.tag_name})+'"'),i.forEach(function(t){return e.nodes[n].tagged.push(t)});var r=performance.now();console.log("\t\t\tCall to commit addTagTemporarely took "+(r-o)+" milliseconds.")},deleteTempItem:function(e,t){var n=t.item,i=e.nodes[n.parent_id];e.nodes[n.parent_id].children=i.children.filter(function(e){return!e.temp}),e.nodes[n.parent_id].children_order=i.children_order.filter(function(e){return!e.toString().includes("tempItem")}),o()(e.nodes).forEach(function(t){t.toString().includes("tempItem")&&vm.$delete(e.nodes,t)})},deleteChild:function(e,t){var n=t.index,i=t.id;e.nodes[i].children.splice(n,1),e.nodes[i].children_order.splice(n,1)},closeFlash:function(e,t){var n=t.flash;e.flashes=e.flashes.filter(function(e){return e!=n})}}},31:function(e,t,n){"use strict";function i(e){var t=[];return e.forEach(function(e){t.push(e),e.children.length&&Array.prototype.push.apply(t,i(e.children))}),t}var o=n(19),r=n(10);t.a={totalPlannedMin:function(){var e=performance.now();console.log("running totalPlannedMin...");var t=store.state.nodes[this.item.id];if(!t)return 0;var n=t.planned_time?parseFloat(t.planned_time):0,i=this.allChildItems;if(!i||!i.length)return n;var o=i.reduce(function(e,t){var n=t?t.planned_time:0;return e+parseFloat(n)},n),r=performance.now();return console.log("\t\t\tcall to totalPlannedMin took "+(r-e)+" milliseconds."),o?parseFloat(o):0},totalUsedSec:function(){var e=performance.now();console.log("running totalUsedSec...");var t=store.state.nodes[this.item.id],n=this.allChildItems;if(!t)return 0;var i=t.used_time?parseFloat(t.used_time):0;if(!n||!n.length)return i;var o=n.reduce(function(e,t){var n=t?t.used_time:0;return e+parseFloat(n)},i),r=performance.now();return console.log("\t\t\tcall to totalUsedSec took "+(r-e)+" milliseconds."),o||0},totalPlannedSec:function(){return console.log("running totalPlannedSec..."),60*this.totalPlannedMin},totalSecLeft:function(){return console.log("running totalSecLeft..."),this.totalPlannedSec-this.totalUsedSec},totalVisiblePlannedMin:function(){var e=performance.now();console.log("running totalVisiblePlannedMin...");var t=store.state.nodes[this.item.id];if(!t)return 0;var n=t.planned_time?parseFloat(t.planned_time):0,i=this.allVisibleChildIds;if(!i||!i.length)return n;var o=i.reduce(function(e,t){var n=store.state.nodes[t],i=n?n.planned_time:0;return e+parseFloat(i)},n),r=performance.now();return console.log("\t\t\tcall to totalVisiblePlannedMin took "+(r-e)+" milliseconds."),o?parseFloat(o):0},totalVisibleUsedSec:function(){var e=performance.now();console.log("running totalVisibleUsedSec...");var t=store.state.nodes[this.item.id],n=this.allVisibleChildIds;if(!t)return 0;var i=t.used_time?parseFloat(t.used_time):0;if(!n||!n.length)return i;var o=n.reduce(function(e,t){var n=store.state.nodes[t],i=n?n.used_time:0;return e+parseFloat(i)},i),r=performance.now();return console.log("\t\t\tcall to totalVisibleUsedSec took "+(r-e)+" milliseconds."),o||0},totalVisiblePlannedSec:function(){return console.log("running totalVisiblePlannedSec..."),60*this.totalVisiblePlannedMin},totalVisibleSecLeft:function(){return console.log("running totalVisibleSecLeft..."),this.totalVisiblePlannedSec-this.totalVisibleUsedSec},secLeft:function(){console.log("running secLeft...");var e=store.state.nodes[this.item.id];return e?60*e.planned_time-e.used_time:0},totalTimeDifferentFromParent:function(){console.log("running totalTimeDifferentFromParent...");var e=store.state.nodes[this.item.id];return e?!e.parent_id||this.totalPlannedSec!=itemGetters[e.parent_id].totalPlannedSec:0},tagsArray:function(){console.log("running tagsArray...");var e=store.state.nodes[this.item.id];return e?e.tagged.map(function(e){return e.tag_name}):[]},siblingIndex:function(){console.log("running siblingIndex...");var e=this.item.id,t=store.state.nodes[e];if(!t)return!1;var n=t.parent_id;return!(!n||!store.state.nodes[n])&&store.state.nodes[n].children_order.indexOf(e)},visibleSiblingIndex:function(){console.log("running siblingIndex...");var e=this.item.id,t=store.state.nodes[e];if(!t)return!1;var n=t.parent_id;return!(!n||!store.state.nodes[n])&&itemGetters[n].visibleDirectChildIds.indexOf(e)},olderSiblingId:function(){console.log("running olderSiblingId...");var e=this.item.id,t=store.state.nodes[e];if(t){var n=t.parent_id;if(n){var i=store.state.nodes[n].children_order;if(i.length<=1||0==this.siblingIndex)return n;var o=i.indexOf(e);return store.state.nodes[n].children_order[o-1]}}},nextItemId:function(){console.log("running nextItemId...");var e=this.item.id;if(e){var t=store.state.nodes[e];if(t){if("journal"==store.state.selection.view){var n=store.getters.filteredItemsFlat.map(function(e){return e.id}),i=n.indexOf(e);return i+1==n.length?n[0]:n[i+1]}if(!store.getters.filteredIdsTree.includes(e)||this.visibleDirectChildren.length&&t.show_children)return this.visibleDirectChildIds.length&&t.show_children?this.visibleDirectChildIds[0]:this.nextItemRecursion;var o=store.getters.filteredIdsTree.indexOf(e);return o+1==store.getters.filteredIdsTree.length?store.getters.filteredIdsTree[0]:store.getters.filteredIdsTree[o+1]}}},nextItemRecursion:function(){console.log("running nextItemRecursion...");var e=this.item.id;if(e){if(this.itIsADeepestChild){var t=this.topLvlParentOfDeepestChild,n=store.getters.filteredIdsTree.indexOf(t);if(n+1==store.getters.filteredIdsTree.length){var i=store.getters.filteredIdsTree[0];return i==e?null:i}return store.getters.filteredIdsTree[n+1]}var o=this.visibleSiblingIndex,r=store.state.nodes[e].parent_id;if(r){var a=itemGetters[r].visibleDirectChildIds;if(o+1==a.length){if(r==store.state.root.id)return;return itemGetters[r].nextItemRecursion}return a[o+1]}}},nextSiblingOrParentsSiblingId:function(){console.log("running nextSiblingOrParentsSiblingId...");var e=store.state.nodes[this.item.id];if(e){var t=e.parent_id;if(t){var n=store.state.nodes[t].children_order,i=this.siblingIndex+1;return i==n.length?itemGetters[t].nextSiblingOrParentsSiblingId:n[i]}}},findDeepestVisibleChild:function(){console.log("running findDeepestVisibleChild...");var e=this.item.id,t=this.visibleDirectChildIds;if(!t.length)return e;var n=t[t.length-1];return itemGetters[n].findDeepestVisibleChild},itIsADeepestChild:function(){console.log("running itIsADeepestChild...");var e=this.item.id;return e?store.getters.filteredItemsTreeDeepestChildren.map(function(e){return e.deepestChild}).includes(e):void console.log("you need an ID")},topLvlParentOfDeepestChild:function(){console.log("running topLvlParentOfDeepestChild...");var e=this.item.id,t=store.getters.filteredItemsTreeDeepestChildren.find(function(t){return t.deepestChild==e});if(t)return t.id},isFirstItem:function(){return console.log("running isFirstItem..."),!store.getters.noItems&&0==this.siblingIndex},prevItemId:function(){console.log("running prevItemId...");var e=this.item.id;if(!e||0==store.state.nodes[e].depth)return!1;var t=void 0;if("journal"==store.state.selection.view){var n=store.getters.filteredItemsFlat.map(function(e){return e.id}),i=n.indexOf(e);t=0==i?n[n.length-1]:n[i-1]}else if(store.getters.filteredIdsTree.includes(e)){var o=store.getters.filteredIdsTree,r=o.indexOf(e);t=0==r?itemGetters[o[o.length-1]].findDeepestVisibleChild:itemGetters[o[r-1]].findDeepestVisibleChild}else{var a=store.state.nodes[this.item.id],d=this.visibleSiblingIndex;if(0==d)t=a.parent_id;else{var s=itemGetters[a.parent_id].visibleDirectChildIds[d-1];t=itemGetters[s].findDeepestVisibleChild}}return t},isTopLvlItemInFilteredRoot:function(){console.log("running isTopLvlItemInFilteredRoot...");var e=this.item.id;return(!store.getters["selection/nothingSelected"]||"tree"!=store.state.selection.view)&&(e==store.state.root.id||store.getters.filteredIdsTree.includes(e))},hasParentDueToday:function(){console.log("running hasParentDueToday...");var e=this.item.id,t=store.state.nodes[e];if(!t.parent_id)return!1;var i=store.state.nodes[t.parent_id];return!!i&&(n.i(o.b)(new Date(i.due_date.replace(/-/g,"/")),new Date)<=0||itemGetters[t.parent_id].hasParentDueToday)},isDueToday:function(){console.log("running isDueToday...");var e=store.state.nodes[this.item.id];return!!e&&n.i(o.b)(new Date(e.due_date.replace(/-/g,"/")),new Date)<=0},isProject:function(){console.log("running isProject...");var e=store.state.nodes[this.item.id];return!!e&&":"==e.body.slice(-1)},itemTagArray:function(){return console.log("running itemTagArray..."),store.state.nodes[this.item.id].tagged.map(function(e){return e.tag_name})},allChildrenAreDone:function(){console.log("running allChildrenAreDone...");var e=this.item.id,t=store.state.nodes[e].children;if(!t.length)return!1;var n=t.reduce(function(e,t){var n=t.done?1:0;return r.d.AplusB(n,e)},0);return t.length==n},calTotalPlannedTime:function(){console.log("running calTotalPlannedTime...");var e=store.state.nodes[this.item.id],t=void 0;return t=Array.isArray(e.children)&&e.children.length?e.children.reduce(function(e,t){var n=t.totalPlannedTime?t.totalPlannedTime:t.planned_time;return e+parseFloat(n)},e.done&&"journal"!=store.state.selection.view?0:parseFloat(e.planned_time)):e.done&&"journal"!=store.state.selection.view?0:parseFloat(e.planned_time),parseFloat(t)},calTotalUsedTime:function(){console.log("running calTotalUsedTime...");var e=store.state.nodes[this.item.id];if(!e)return 0;var t=void 0;return t=Array.isArray(e.children)&&e.children.length?e.children.reduce(function(e,t){var n=t.totalUsedTime?t.totalUsedTime:t.used_time;return e+parseFloat(n)},e.done&&"journal"!=store.state.selection.view?0:parseFloat(e.used_time)):e.done&&"journal"!=store.state.selection.view?0:parseFloat(e.used_time),parseFloat(t)},allChildItems:function(){return console.log("running allVisibleChildItems..."),i(this.item.children)},allVisibleChildItems:function(){return console.log("running allVisibleChildItems..."),i(this.visibleDirectChildren).filter(function(e){return store.getters.filteredIdsFlat.includes(e.id)})},allVisibleChildIds:function(){return console.log("running allVisibleChildIds..."),this.allVisibleChildItems.map(function(e){return e.id})},visibleDirectChildren:function(){var e=store.state.nodes[this.item.id];return e&&e.children.length&&e.show_children?e.children.filter(function(e){return store.getters.filteredIdsFlat.includes(e.id)}):[]},visibleDirectChildIds:function(){return console.log("running visibleDirectChildIds..."),this.visibleDirectChildren.map(function(e){return e.id})},clipboardText:function(){console.log("running clipboardText...");var e=this.item.id,t=store.state.nodes[e],n=void 0,i=void 0,o=0;return this.$store.getters["selection/dueTodayFiltered"]?i=!0:o=parseFloat(t.depth),n=this.allVisibleChildItems,t?n.reduce(function(e,t){return e+"\n"+"　　".repeat(i?0:parseFloat(t.depth)-o)+"・"+t.body},""+t.body):""}}},33:function(e,t,n){"use strict";function i(e){var t=performance.now();e||console.log("item undefffff"),e.depth=Number(e.depth),null==e.show_children&&(e.show_children=1),e.children||(e.children=[]),e.due_date||(e.due_date="0000-00-00 00:00:00"),e.done_date||(e.done_date="0000-00-00 00:00:00"),e.done||(e.done=!1),e.planned_time||(e.planned_time=0),e.used_time||(e.used_time=0),e.tagged||(e.tagged=[]),e.children_order?"string"==typeof e.children_order&&(e.children_order=e.children_order.split(",").map(Number)):e.children_order=[];var n=performance.now();return console.log("\t\t\tCall to setDefaultItemValues took "+(n-t)+" milliseconds."),e}t.a=i},348:function(e,t){},349:function(e,t){},350:function(e,t){},358:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},staticRenderFns:[]}},363:function(e,t,n){function i(e){var t=o[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var o={"./Error404.vue":[366,6],"./Hello.vue":[367,5],"./Index.vue":[368,1],"./Listo.vue":[369,0],"./Login.vue":[370,3],"./QuasarSplash.vue":[371,4],"./Register.vue":[372,2]};i.keys=function(){return Object.keys(o)},e.exports=i,i.id=363},67:function(e,t,n){"use strict";t.a={en:{global:{sec:"sec",min:"min",hour:"hour",m:"m",h:"h",s:"s",cancel:"Cancel",delete:"Delete",save:"Save",reload:"Reload"},user:{login:"Login",logout:"Logout",register:"Register",email:"Email Address",password:"Password",passwordConfirm:"Please type password again",showpassword:"Show password",name:"Name"},menu:{all:"All",today:"Today",journal:"Journal","?":"?",usedTime:"Used time",timeLeft:"Time left",items:"Items",done:"Done",total:"Total"},card:{duration:"Duration:",addTag:"Add tag:",edit:"Edit",copy:"Copy",setToday:"Do today",addAndContinue:"Add and continue",addAndClose:"Add and close",addNew:"Add new..."},tags:{done:"Done",today:"Today"},popouts:{reset:"Reset",ok:"Ok",reallyDelete:"Really delete",andAllChildren:"And all children",overtime:"overtime",total:"Total"},popups:{journalNotes:"Journal notes",journalNotesPopover:"Edit journal notes",completed:"Completed",completedB:"",usedTime:"Used time",reset:"Reset",setNotDone:"Undo completion"},guide:{action:"Action",key:"Key",keybindings:[{key:"T",note:"Do <u>T</u>oday"},{key:"S",note:"<u>S</u>topwatch / Timer"},{key:"tab",note:"Indent item"},{key:"enter",note:"Add item"},{key:"cmd/ctrl + enter",note:"Edit item"},{key:"shift + T",note:"Edit tags"},{key:"alt + click on tag",note:"Hide tag"},{key:"cmd/ctrl + ↑↓",note:"Move item up/down"},{key:"ctrl + shift + D",note:"Duplicate item"}],hints:{addItemHint:"Add some items!"}},flashes:{moveTopLvlItem:"You cannot move this item when there is a filter.",cannotDoThisInJournal:"You cannot do this in the Journal.",ajaxError:"Error with connection. Reloading in "}},ja:{global:{sec:"秒",min:"分",hour:"時",m:"分",h:"時",s:"秒",cancel:"キャンセル",delete:"削除",save:"保存",reload:"再読込"},user:{login:"ログイン",logout:"ログアウト",register:"登録",email:"メールアドレス",password:"パスワード",passwordConfirm:"パスワードを再度入力",showpassword:"パスワードを表示",name:"名前"},menu:{all:"全て",today:"今日",journal:"日報","?":"？",usedTime:"使用時間",timeLeft:"残時間",items:"アイテム",done:"完了",total:"合計"},card:{duration:"使用時間:",addTag:"タグを追加:",edit:"編集",copy:"コピー",setToday:"今日やる",addAndContinue:"複数追加",addAndClose:"追加して閉じる",addNew:"追加..."},tags:{done:"完了",today:"今日"},popouts:{reset:"リセット",ok:"Ok",reallyDelete:"本当に削除しますか？",andAllChildren:"とその中の全てのアイテム",overtime:"オーバータイム",total:"合計"},popups:{journalNotes:"日報メモ",journalNotesPopover:"日報メモを編集",completed:"",completedB:"を完了致しました",usedTime:"使用時間",reset:"リセット",setNotDone:"完了取り消し"},guide:{action:"アクション",key:"ショートカットキー",keybindings:[{key:"T",note:"今日のタスクとして設定"},{key:"S",note:"ストップウォッチ / タイマー"},{key:"tab",note:"アイテムを右へ"},{key:"enter",note:"アイテムを追加"},{key:"cmd/ctrl + enter",note:"アイテムを編集"},{key:"shift + T",note:"タグを編集"},{key:"alt + click on tag",note:"タグのアイテムを非表示"},{key:"cmd/ctrl + ↑↓",note:"アイテムを上下へ移動"},{key:"ctrl + shift + D",note:"アイテムを複製"}],hints:{addItemHint:"アイテムを追加しよう！"}},flashes:{moveTopLvlItem:"フィルタをかけた際、このアイテムは動かせません。",cannotDoThisInJournal:"日報では機能しません。",ajaxError:"接続エラー。再読込まで "}}}},68:function(e,t,n){"use strict";var i=n(20),o=(n.n(i),n(67)),r=n(156),a=n(33);n(31);window.apiBaseURL="http://api.lucaban.com/";var d=n.i(a.a)({id:"z",depth:0,temp:!0,body:"ALL"}),s={};s[d.id]=d;t.a=function(){return{languageContents:o.a,keybindings:r.a,nodes:s,source:d,root:d,apiBaseURL:apiBaseURL,orphans:[],debug:!1,doneData:null,addingNewUnder:null,addingNewAsChild:!1,addingNewAsFirstChild:!1,editingItem:null,editingItemTags:null,editingDoneDateItem:null,loading:!1,patching:!1,popups:[],popouts:{delete:[],timer:[],edit:[],guide:!1},flashes:[],timerItems:[],beforeEditCache_body:null,beforeEditCache_planned_time:null,fetchedDone:!1,blockBlur:!1,manualMobile:!1,newTag:null,setLanguage:null}}}},[152]);